\documentclass[eng,printmode,oneside]{mgr}
\usepackage[MeX]{polski}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} 
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{psfrag}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{supertabular}
\usepackage{array}
\usepackage{tabularx}
\usepackage{hhline}
\usepackage{rev}
%\usepackage{framed}
\usepackage{color}
\usepackage{url}
%\usepackage[notref]{showkeys}
%\usepackage{showlabels}
\usepackage{float}
\usepackage{tikz}
\usepackage{enumitem} 
\usepackage{bm}

\reviewer{dypl}{0.2}{0.2}{0.67}
\reviewer{prof}{0.2}{0.6}{0.2}
\def\bp{\begin{review}[prof]}
\def\ep{\end{review}}
\def\bdypl{\begin{review}[dypl]}
\def\edypl{\end{review}}
\newcommand{\R}{I\!\!R} 
\newtheorem{theorem}{Twierdzenie}[section] 
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newenvironment{myitemize}%
 { \begin{list}{\labelitemi}%
   {
      \setlength{\itemsep}{0mm}%
      \setlength{\topsep}{6pt}%
      \setlength{\leftmargin}{5mm}%
     \setlength{\parsep}{1mm}%
    }
  }
{\end{list}
}
\newcounter{mycount}
\newenvironment{MYenumerate}%
 {\begin{list}{\arabic{mycount}.}%
   {\usecounter{mycount}%
%      \setlength{\topsep}{12pt}%
      \setlength{\topsep}{6pt}%
      \setlength{\itemsep}{0mm}%
      \setlength{\leftmargin}{7mm}%
     \setlength{\parsep}{1mm}%
    }%
 }%
{\end{list}}
\newenvironment{todo}
{
\label{todo}
\color{red} [
}
{]
}

\title{Planowanie ruchu bramkarza sportowego jako kinematyczne zadanie robotyczne}
\engtitle{Planning a goalkeeper's motion as a kinematic task of robotics}

\author{Bernard Malec}
\supervisor{Prof.\ dr hab.\ inż.\ Ignacy Dulęba}


\field{Automatyka i Robotyka (AIR)}
\specialisation{Robotyka (ARR)}

%\includeonly{mch0,mch1,mch2,mch3,mch4,bibl}
%\includeonly{mch3}

\begin{document}
\bibliographystyle{plabbrv} %BibTeX polski styl bibliografii 

% te ozdobniki dodaje się dopiero na końcu 
%\maketitle
%\tableofcontents


\chapter{Model manipulatora mobilnego}
Manipulator mobilny to platforma mobilna z zamontowanym na niej manipulatorem. Biorąc pod uwagę typ ograniczeń nałożonych kolejno na platformę i manipulator można wydzielić 4 typy manipulatorów mobilnych:
\begin{enumerate}
\item typ (\textit{h,h}) - platforma i manipulator związane są ograniczeniami holonomicznymi,
\item typ (\textit{nh,h}) - na platformę nałożone są ograniczenia nieholonomiczne, natomiast na manipulator ograniczenia holonomiczne,
\item typ (\textit{nh,nh}) - ograniczenia nałożone na platformę i manipulator są nieholonomiczne. Taki  rodzaj manipulatora mobilnego został przedstawiony w \cite{5},
\item typ (\textit{h,nh}) - na manipulator  nałożone są ograniczenia nieholonomiczne, natomiast na platformę holonomiczne.
\end{enumerate} 

W tym rozdziale zostanie przedstawiony model manipulatora mobilnego typu (\textit{nh,h}). W szczególności w rozważanym manipulatorze platformą będzie monocykl, czyli robot mobilny klasy (2,0). Za manipulator natomiast posłuży manipulator RTR. Rozważany manipulator mobilny przedstawiono na rys 1.

Przyjmy następujący wektor współrzędnych uogólnionych manipulatora mobilnego:
\begin{equation}
q=\left(
\begin{array}{c}
q_m\\
q_r\\
\end{array}
\right)\in R^{n+p},
\end{equation}
gdzie $q_m=(x,y,\theta, \phi_1, \phi_2)^T \in R^n$ - wektor współrzędnych uogólnionych platformy mobilnej, $q_r=(q_1,q_2,q_3)^T \in R^p$ - wektor współrzędnych przegubowych manipulatora. Rozmiary przestrzeni wyniosą więc $n=5$, $p=3$.
\section{Model we współrzędnych uogólnionych}
Do wyprowadzenia równań manipulatora mobilnego wykorzystamy mechanikę Langrange'ą.\\ Lagranżjan L jest zdefiniowany jako różnica pomiędzy energią kinetyczną, a potencjalną układu
\begin{equation}
L(q,\dot{q})=T(q,\dot{q})-V(q).
\end{equation}
Równania ruchu przy braku sił działających na system są następujące
\begin{equation}
\label{lagrange}
\frac{d}{dt}(\frac{\partial L}{\partial\dot{q}})-\frac{\partial L}{\partial q}=0.
\end{equation}
Lewą stronę równania \eqref{lagrange} można przedstawić jako
\begin{equation}
\label{lagrange2}
\frac{d}{dt}(\frac{\partial L}{\partial \dot{q}})-\frac{\partial L}{\partial q}=Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q).
\end{equation}
Przy obecności sił zewnętrznych równanie \eqref{lagrange} wygląda następująco
\begin{equation}
\label{lagrange3}
Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)=F_e.
\end{equation}
W naszym przypadku siły zewnętrze $F_e$ są sumą 2 składowych: $F_e=B(q)u+F_{nh}$, gdzie $B(q)u$ to uogólnione siły wejściowe(tj. wywierane na system przez elementy wykonawcze), a $F_{nh}$ to siły więzów nieholonomicznych(tj. siły zapewniające spełnienie ograniczeń nieholonomicznych).\\
\section{Ograniczenia nieholonomiczne dla platformy}
W naszym przypadku platforma manipulatora mobilnego to monocykl, który w założeniu będzie poruszać się bez poślizgu wzdłużnego i poprzecznego kół.\\
Warunek na brak poślizgu poprzecznego to\\
\begin{equation}
\dot{x}\sin(\theta)-\dot{y}\cos(\theta)=0,
\end{equation} 
a warunki na brak poślizgu wzdłużnego pierwszego i drugiego koła to:\\
\begin{equation}
\dot{x}\cos(\theta)+\dot{y}\sin(\theta)-L\dot{\theta}-R\phi_1=0,
\end{equation}
\begin{equation}
\dot{x}\cos(\theta)+\dot{y}\sin(\theta)+L\dot{\theta}-R\phi_2=0.
\end{equation}
Ograniczenia te są nieholonomiczne i można je przedstawić w postaci Pfaffa
\begin{equation}
\label{pfaff}
A(q)\dot{q}=0,
\end{equation}
gdzie
\begin{equation}
A(q)=\begin{bmatrix}
    \sin(\theta)  &-\cos(\theta) & 0&0&0&0&0&0 \\
    \cos(\theta)  &\sin(\theta) & -L&-R&0&0&0&0\\
     \cos(\theta)  &\sin(\theta) & L&0&-R&0&0&0       
\end{bmatrix}.
\end{equation}
Z \cite{5} wiemy, że siła więzów nieholonomicznych równa jest $F_{nh}=A(q)^T\lambda$, gdzie $\lambda$ to wektor mnożników Lagrange'a. Równanie (\ref{lagrange3}) można więc teraz zapisać jako
\begin{equation}
\label{lagrange4}
Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)=B(q)u+A(q)^T\lambda .
\end{equation}
\section{Model w prędkościach pomocniczych}
Model postaci (\ref{lagrange4}) posiada pewne wady: macierz $B$ jest prostokątna i nie daje się odwrócić. W jawnej postaci występują również mnożniki Lagrange'a odpowiadające siłom tarcia statycznego zależnego od $u$, $q$, $\dot{q}$, $t$. Aby pozbyć się tych wad można przekształcić (\ref{lagrange4}) do modelu wyrażonego w prędkościach pomocniczych.\\
\par Najpierw zauważmy, że ograniczenia (\ref{pfaff}) wymagają aby prędkości $\dot{q}$ należały do jądra macierzy $A(q)$. Niech baza jądra $A(q)$ będzie zbiorem wektorów $\{g_1(q), g_2(q),..., g_m(q)\}$. Jeśli więc zapiszemy prędkość $\dot{q}$ w następujący sposób 
\begin{equation}
\label{niewiem1}
\dot{q}=\sum_{k=1}^{m} g_k(q)\eta_k=\left(
\begin{array}{c} g_1(q), g_2(q),..., g_m(q)\end{array}\right)\left(
\begin{array}{c}
\eta_1\\
\vdots\\
\eta_m
\end{array}\right)
=G(q)\eta
\end{equation}
to będzie ona spełniać ograniczenia (\ref{pfaff}).
Wektor $\eta$ nazywamy wektorem prędkości pomocniczych.\\
\par Zauważmy, że
\begin{equation}
\label{AG}
A(q)G(q)=0.
\end{equation}
Biorąc transpozycje (\ref{AG}) otrzymamy
\begin{equation}
\label{AG2}
G^T(q)A^T(q)=0.
\end{equation}
Aby wyeliminować mnożniki Lagrange'a z (\ref{lagrange4}) należy pomnożyć (\ref{lagrange4}) lewostronnie przez  $G^T$(dla czytelności pomińmy argumenty) i skorzystać z (\ref{AG2}). Otrzymamy wtedy
\begin{equation}
\label{predkoscipomoc1}
G^TQ\ddot{q}+G^TC\dot{q}+G^TD=G^TBu+G^TA^T\lambda =G^TBu.
\end{equation}
Zróżniczkujmy jeszcze (\ref{niewiem1}) po czasie
\begin{equation}
\label{niewiem2}
\ddot{q}=\dot{G}\eta+G\dot{\eta}.
\end{equation}
Po podstawieniu (\ref{niewiem1}) i (\ref{niewiem2}) do (\ref{predkoscipomoc1}), otrzymamy model w prędkościach pomocniczych:
\begin{equation}
G^TQ(\dot{G}\eta+G\dot{\eta})+G^TCG\eta+G^TD=G^TQG\dot{\eta}+G^T(Q\dot{G}+CG)\eta+G^TD=G^TBu,
\end{equation}
czyli
\begin{equation}
Q^*\dot{\eta}+C^*\eta+D^*=B^*u,
\end{equation}
gdzie:
\begin{align*}
 Q^*&=G^TQG,\\
 C^*&=G^T(Q\dot{G}+CG),\\
 D^*&=G^TD,\\
 B^*&=G^TB.
\end{align*}
\chapter{Odsprzęganie wejściowo-wyjściowe}
Algorytm odsprzęgania wejściowo-wyjściowego jest wykorzystywany do sterowania manipulatorów mobilnych. Rozwiązuje on zadanie śledzenia zadanej trajektorii efektora $y_d(t)$ w przestrzeni zewnętrznej. Polega on na zastosowaniu dwóch pętli sprzężenia zwrotnego, aby sprowadzić równania manipulatora mobilnego do liniowej postaci $\ddot{y}(t)=\zeta$, gdzie $\zeta$ jest nowym sterowaniem. Algorytm odpsprzęgania wejściowo-wyjściowego wymaga pełnej znajomości modelu manipulatora mobilnego.\\ 

 \noindent Istnieją dwie wersje tego algorytmu dla manipulatorów mobilnych (\textit{nh},\textit{h}):
\begin{itemize}[noitemsep,topsep=0pt]
\item oryginalny algorytm Yamamoto i Yuna \cite{2}\cite{3}
\item algorytm z rozszerzonymi funkcjami wyjściowymi\cite{1}
\end{itemize}\vspace{0.2cm}
W tej pracy użyto algorytmu z rozszerzonymi funkcjami wyjściowymi. Funkcje wyjściowe mają wtedy postacie\cite{1}:
\begin{equation}
y(q)=\left(
\begin{array}{c}
y_1(q_m,q_r)\\
y_2(q_r)\\
\end{array}
\right),
\end{equation}
gdzie $y_1(q_m,q_r)$ jest wektorem wybranych współrzędnych efektora w podstawowym układzie odniesienia ($X_0$,$Y_0$), a $y_2(q_r)$ to wektor wybranych współrzędnych efektora w lokalnym układzie odniesienia ($X_P$,$Y_P$) związanym ze środkiem masy\cite{1}.\\
Algorytm odsprzęgania wejściowo-wyjściowego dla manipulatorów mobilnych złożony jest z dwóch pętli sprzeżeń zwrotnych\cite{1}:
\begin{itemize}[noitemsep,topsep=0pt]
\item wewnętrznej pętli linearyzującej transformację wejście-stan
\item zewnętrzej pętli linearyzującej transformację wejście-wyjście
\end{itemize}
Wewnętrzna pętla realizuje linearyzacje transformacji wejście-stan i wykorzystuje w tym celu prawo sterowania z rodziny algorytmów 'obliczanych momentów'\cite{1}:
\begin{equation}
\label{eq:petla1}
u=B^{*-1}[C^*z+D^*+Q^*v].
\end{equation}
Zewnętrza pętla zapewnia linearyzacje transformacji wejście-wyjście i jest realizowana za pomocą prawa sterowania\cite{1}:
\begin{equation}
\label{eq:petla2}
v=\Phi^{-1}[-\Phi z+\zeta].
\end{equation}
Macierz $\Phi(q)$ jest następująca \[
\Phi=
\begin{bmatrix}
    \Phi_m       & \Phi_{mr} \\
    0       & \Phi_r  \\
\end{bmatrix}=
\begin{bmatrix}
    \frac{\partial y_1}{\partial q_m} G      & \frac{\partial y_1}{\partial q_r}  \\
    0       & \frac{\partial y_2}{\partial q_r} \\
\end{bmatrix}.
\]
Prawo sterowania zewnętrznej pętli (\ref{eq:petla2}) wyprowadza się w następujący sposób:\\
Oblicza się pochodną funkcji wyjściowej $y(q)$ po czasie:
\begin{equation}
\dot{y}(q)=
\left(
\begin{array}{c}
    \frac{\partial y_1}{\partial q_m} \dot{q}_m  + \frac{\partial y_1}{\partial q_r} \dot{q}_r \\
     \frac{\partial y_2}{\partial q_r} \dot{q}_r\\
\end{array}
\right)=
\begin{bmatrix}
    \frac{\partial y_1}{\partial q_m} G     & \frac{\partial y_1}{\partial q_r}  \\
    0       & \frac{\partial y_2}{\partial q_r} \\
\end{bmatrix}
\left(
\begin{array}{c}
\eta\\
\dot{q}_r\\
\end{array}
\right)=\Phi(q)z,
\end{equation} 
$\dot{y}(q)$ ponownie różniczkuje się po czasie:
\begin{equation}
\label{eq:1}
\ddot{y}=\dot{\Phi}z+\Phi \dot{z}.
\end{equation} 
Stosując pierwszą pętlę (\ref{eq:petla1}) do modelu (\ref{eq:model}) mamy:
\begin{equation}
\label{eq:2}
\dot{z}=v.
\end{equation}
Po podstawieniu zależności (\ref{eq:2}) do równania (\ref{eq:1}) uzyskamy:
\begin{equation}
\ddot{y}=\dot{\Phi}z+\Phi v.
\end{equation} 
Aby zapewnić linearyzację wejściowo-wyjściową należy więc użyć wejścia:
\begin{equation}
v=\Phi ^{-1}[-\Phi z+\zeta].
\end{equation}
\subsection{Warunki działania algorytmu}
Wyżej przedstawiony algorytm wymaga odwracalności macierzy $\Phi$. Warunek jaki trzeba spełnić aby algorytm funkcjonował jest więc następujący:
\begin{equation}
\text{det}(\Phi)=\text{det}(\Phi_m)\text{det}(\Phi_r)\neq0
\end{equation}
\section{Badania symulacyjne}
\begin{thebibliography}{99}
\bibitem{1} Mazur A. \textit{New approach to designing input-output decoupling controllers for mobile manipulators}. Bull. of the Polish Academy of sciences Tech. Sci. 53(1):31-37, (2005)

\bibitem{2} Yamamoto Y, Yun X. \textit{Coordinating locomotion and manipulation of a mobile manipulator.} IEEE Trans. on Automatic Control, 39(6):1326-1332, (1994)

\bibitem{3} Yamamoto Y, Yun X. \textit{Effect of the dynamic interaction on coordinated control of mobile manipulators.} IEEE Trans. Robotics Automat, 12(5):816-824, (1996)

\bibitem{4} Mazur A, Arent K. \textit{Lecture Notes in Control and Information Sciences}, 335:55-71 (2007)

\bibitem{5} Tchoń K, Jakubiak J. \textit{Acceleration-Driven Kinematics of Mobile Manipulators: An Endogenous Configuration Space Approach}, pp.(469-476),  (2004)

\bibitem{5} M. R. Flannery. \textit{The Enigma of Nonholonomic Constraints.} American Association of Physics Teachers, 73(3):265–272, 2005.
\end{thebibliography}

%\include{bibl}



%\bibliography{bibliografia} % bibliografia.bib

%opcjonalnie może się tu pojawić spis rysunków i tabel
% \listoffigures
% \listoftables
\end{document}
