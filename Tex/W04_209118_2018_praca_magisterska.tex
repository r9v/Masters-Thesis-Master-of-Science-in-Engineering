\documentclass[eng,printmode,oneside]{mgr}
\usepackage[MeX]{polski}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} 
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{psfrag}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{supertabular}
\usepackage{array}
\usepackage{tabularx}
\usepackage{hhline}
\usepackage{rev}
%\usepackage{framed}
\usepackage{color}
\usepackage{url}
%\usepackage[notref]{showkeys}
%\usepackage{showlabels}
\usepackage{float}
%\usepackage{tikz}
\usepackage{enumitem} 
\usepackage{graphicx}       
\usepackage{rotating}       % pakiet umożliwiający obracanie rysunków
\usepackage{subfigure}      % pakiet umożliwiający tworzenie podrysunków
\usepackage{epic}           % pakiet umożliwiający rysowanie w środowisku latex
\usepackage{listings}       % pakiet dedykowany zrodlom programow
\usepackage{verbatim}       % pakiet dedykowany rozmaitym wydrukom tekstowym
\usepackage{amssymb}        % pakiet z rozmaitymi symbolami matematycznymi
\usepackage{amsmath}        % pakiet z rozmaitymi środowiskami matematycznymi
\usepackage[polish]{babel}  % pakiet lokalizujący dokument w języku polskim
\usepackage[OT4]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{bm}
\usepackage{gensymb}
\usepackage{booktabs}
\usepackage{epstopdf}
\usepackage{amssymb}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphics}
\usepackage[]{algorithmic} %pseudocode
\usepackage[]{algorithm2e} %pseudocode
\usepackage{float}
\usepackage{csquotes}
\usepackage{epsfig}
%\usepackage{hyperref}
\usepackage{wrapfig} 
\reviewer{dypl}{0.2}{0.2}{0.67}
\reviewer{prof}{0.2}{0.6}{0.2}
\def\bp{\begin{review}[prof]}
\def\ep{\end{review}}
\def\bdypl{\begin{review}[dypl]}
\def\edypl{\end{review}}
\newcommand{\R}{I\!\!R} 
\newtheorem{theorem}{Twierdzenie}[section] 
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newenvironment{myitemize}%
 { \begin{list}{\labelitemi}%
   {
      \setlength{\itemsep}{0mm}%
      \setlength{\topsep}{6pt}%
      \setlength{\leftmargin}{5mm}%
     \setlength{\parsep}{1mm}%
    }
  }
{\end{list}
}
\newcounter{mycount}
\newenvironment{MYenumerate}%
 {\begin{list}{\arabic{mycount}.}%
   {\usecounter{mycount}%
%      \setlength{\topsep}{12pt}%
      \setlength{\topsep}{6pt}%
      \setlength{\itemsep}{0mm}%
      \setlength{\leftmargin}{7mm}%
     \setlength{\parsep}{1mm}%
    }%
 }%
{\end{list}}
\newenvironment{todo}
{
\label{todo}
\color{red} [
}
{]
}
%%%%%%%%%chapter no new page%
\usepackage{etoolbox}
\makeatletter
\patchcmd{\chapter}{\if@openright\cleardoublepage\else\clearpage\fi}{}{}{}
\makeatother
%%%%%%%%%%%%%
\title{Planowanie ruchu bramkarza sportowego jako kinematyczne zadanie robotyczne}
\engtitle{Planning a goalkeeper's motion as a kinematic task of robotics}

\author{Bernard Malec}
\supervisor{Prof.\ dr hab.\ inż.\ Ignacy Dulęba}


\field{Automatyka i Robotyka (AIR)}
\specialisation{Robotyka (ARR)}

%\includeonly{mch0,mch1,mch2,mch3,mch4,bibl}
%\includeonly{mch3}

\begin{document}
\bibliographystyle{plabbrv} %BibTeX polski styl bibliografii 

% te ozdobniki dodaje się dopiero na końcu 
%\maketitle
\tableofcontents

\chapter{Wstęp}
\section{Cel pracy}
\section{Zawartość pracy}
\chapter{Model manipulatora mobilnego}
Manipulator mobilny to platforma mobilna z zamontowanym na niej manipulatorem. Biorąc pod uwagę typ ograniczeń nałożonych kolejno na platformę i manipulator można wydzielić 4 typy manipulatorów mobilnych:
\begin{enumerate}
\item typ (\textit{h,h}) - platforma i manipulator związane są ograniczeniami holonomicznymi,
\item typ (\textit{nh,h}) - na platformę nałożone są ograniczenia nieholonomiczne, natomiast na manipulator ograniczenia holonomiczne,
\item typ (\textit{nh,nh}) - ograniczenia nałożone na platformę i manipulator są nieholonomiczne. Taki  rodzaj manipulatora mobilnego został przedstawiony w \cite{5},
\item typ (\textit{h,nh}) - na manipulator  nałożone są ograniczenia nieholonomiczne, natomiast na platformę holonomiczne.
\end{enumerate} 

W tym rozdziale zostanie przedstawiony model manipulatora mobilnego typu (\textit{nh,h}). W szczególności w rozważanym manipulatorze platformą będzie monocykl, czyli robot mobilny klasy (2,0). Za manipulator natomiast posłuży manipulator RTR. Rozważany manipulator mobilny przedstawiono na rys 1.

Przyjmy następujący wektor współrzędnych uogólnionych manipulatora mobilnego:
\begin{equation}
q=\left(
\begin{array}{c}
q_m\\
q_r\\
\end{array}
\right)\in R^{n+p},
\end{equation}
gdzie $q_m=(x,y,\theta, \phi_1, \phi_2)^T \in R^n$ - wektor współrzędnych uogólnionych platformy mobilnej, $q_r=(q_1,q_2,q_3)^T \in R^p$ - wektor współrzędnych przegubowych manipulatora. Rozmiary przestrzeni wyniosą więc $n=5$, $p=3$.
\section{Model we współrzędnych uogólnionych} \label{model1s}
Do wyprowadzenia równań manipulatora mobilnego wykorzystamy mechanikę Langrange'ą.\\ Lagranżjan L jest zdefiniowany jako różnica pomiędzy energią kinetyczną, a potencjalną układu
\begin{equation}
L(q,\dot{q})=T(q,\dot{q})-V(q).
\end{equation}
Równania ruchu przy braku sił działających na system są następujące
\begin{equation}
\label{lagrange}
\frac{d}{dt}(\frac{\partial L}{\partial\dot{q}})-\frac{\partial L}{\partial q}=0.
\end{equation}
Lewą stronę równania \eqref{lagrange} można przedstawić jako
\begin{equation}
\label{lagrange2}
\frac{d}{dt}(\frac{\partial L}{\partial \dot{q}})-\frac{\partial L}{\partial q}=Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q).
\end{equation}
Przy obecności sił zewnętrznych równanie \eqref{lagrange} wygląda następująco
\begin{equation}
\label{lagrange3}
Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)=F_e.
\end{equation}
W naszym przypadku siły zewnętrze $F_e$ są sumą 2 składowych: $F_e=B(q)u+F_{nh}$, gdzie $B(q)u$ to uogólnione siły wejściowe(tj. wywierane na system przez elementy wykonawcze), a $F_{nh}$ to siły więzów nieholonomicznych(tj. siły zapewniające spełnienie ograniczeń nieholonomicznych). \\Wektor $u=\left(
\begin{array}{c}
u_m\\
u_r
\end{array}\right)\in R^{(n+p-l)}$ jest wektorem sterowań.\\ Macierz
$B(q)=\begin{bmatrix}
    B(q_m)  &0\\
    0  &I_p \\
\end{bmatrix} \in R^{(n+p)\times(n+p-l)} $ nazywana jest macierzą wejściową. \\$l$ jest liczbą ograniczeń nieholonomicznych.\\ Łatwo zauważyć, że jeśli obecne jest chociaż jedno ograniczenie nieholonomiczne macierz $B(q)$ nie jest macierzą kwadratową, przez co nie można jej odwrócić. 
\section{Ograniczenia nieholonomiczne}
W naszym przypadku platformą manipulatora mobilnego jest monocykl. W założeniu ma poruszać się ona bez poślizgu wzdłużnego i poprzecznego kół. Ograniczenia te są z natury nieholonomiczne i można je przedstawić w postaci Pfaffa
\begin{equation}
\label{pfaff}
A(q)\dot{q}=0,
\end{equation}
Jako, że ograniczenia nieholonomiczne dotyczą tylko platformy zapiszmy $A(q)$ następująco 
\begin{equation}
A(q)=\begin{bmatrix}
   A(q_m)&0\\
\end{bmatrix}
\in R^{l\times(n+p)}.
\end{equation}
Z \cite{6} wiemy, że siła więzów nieholonomicznych równa jest $F_{nh}=A(q)^T\lambda$, gdzie $\lambda$ to wektor mnożników Lagrange'a. Równanie (\ref{lagrange3}) można więc teraz zapisać jako
\begin{equation}
\label{lagrange4}
Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)=B(q)u+A(q)^T\lambda .
\end{equation}
\section{Model w prędkościach pomocniczych}
Model postaci (\ref{lagrange4}) posiada pewne wady: jak wspomniano w (\ref{model1s}) macierz $B(q)$ nie daje się odwrócić z powodu obecności ograniczeń nieholonomicznych. W jawnej postaci występują również mnożniki Lagrange'a odpowiadające siłom tarcia statycznego zależnego od $u$, $q$, $\dot{q}$, $t$. Aby pozbyć się tych wad można przekształcić (\ref{lagrange4}) do modelu wyrażonego w prędkościach pomocniczych.\\
\par Zauważmy najpierw, że ograniczenia (\ref{pfaff}) wymagają aby prędkość $\dot{q}$ należała do jądra macierzy $A(q)$. \\
Niech baza jądra $A(q_m)$ będzie zbiorem wektorów $\{g_1(q_m), g_2(q_m),..., g_m(q_m)\}$. Zapiszmy prędkość $\dot{q}_m$ w następujący sposób 
\begin{equation}
\dot{q}_m=\sum_{k=1}^{n} g_k(q_m)\eta_k=\begin{bmatrix}
   g_1(q_m)& g_2(q_m)&...& g_m(q_m)\\
\end{bmatrix}
\left(
\begin{array}{c}
\eta_1\\
\vdots\\
\eta_m
\end{array}\right)
=G_m(q_m)\eta.
\end{equation}
Wektor $\eta$ nazywamy wektorem prędkości pomocniczych.\\
Zauważmy, że prędkość 
\begin{equation}
\label{niewiem1}
\dot{q}=G(q)z,
\end{equation}
gdzie $G(q)=\begin{bmatrix}
    G_m(q_m)  &0\\
    0  &I_p \\
\end{bmatrix}$ i $z=\left(
\begin{array}{c}
\eta\\
\dot{q}_r\\
\end{array}
\right)$ należy do jądra macierzy $A(q)$ i tym samym spełnia ograniczenia (\ref{pfaff}).
\par Możemy więc zapisać, że
\begin{equation}
\label{AG}
A(q)G(q)=0.
\end{equation}
Biorąc transpozycje (\ref{AG}) otrzymamy
\begin{equation}
\label{AG2}
G^T(q)A^T(q)=0.
\end{equation}
Aby wyeliminować mnożniki Lagrange'a z (\ref{lagrange4}) należy pomnożyć (\ref{lagrange4}) lewostronnie przez  $G^T$(dla czytelności pomińmy argumenty) i skorzystać z (\ref{AG2}). Otrzymamy wtedy
\begin{equation}
\label{predkoscipomoc1}
G^TQ\ddot{q}+G^TC\dot{q}+G^TD=G^TBu+G^TA^T\lambda =G^TBu.
\end{equation}
Zróżniczkujmy jeszcze (\ref{niewiem1}) po czasie
\begin{equation}
\label{niewiem2}
\ddot{q}=\dot{G}z+G\dot{z}.
\end{equation}
Po podstawieniu (\ref{niewiem1}) i (\ref{niewiem2}) do (\ref{predkoscipomoc1}), otrzymamy model w prędkościach pomocniczych:
\begin{equation}
G^TQ(\dot{G}z+G\dot{z})+G^TCGz+G^TD=G^TQG\dot{z}+G^T(Q\dot{G}+CG)z+G^TD=G^TBu,
\end{equation}
czyli
\begin{equation}
\label{modelpp}
Q^*\dot{z}+C^*z+D^*=B^*u,
\end{equation}
gdzie:
\begin{align*}
 Q^*&=G^TQG,\\
 C^*&=G^T(Q\dot{G}+CG),\\
 D^*&=G^TD,\\
 B^*&=G^TB.
\end{align*}
\chapter{Odsprzęganie wejściowo-wyjściowe dla manipulatora mobilnego}
Algorytm odsprzęgania wejściowo-wyjściowego jest wykorzystywany do sterowania manipulatorów mobilnych. Rozwiązuje on zadanie śledzenia zadanej trajektorii efektora $y_d(t)$ w przestrzeni zewnętrznej. Algorytm odpsprzęgania wejściowo-wyjściowego wymaga pełnej znajomości modelu manipulatora mobilnego.\\ 

 \noindent Istnieją dwie wersje tego algorytmu dla manipulatorów mobilnych (\textit{nh},\textit{h}):
\begin{itemize}[noitemsep,topsep=0pt]
\item oryginalny algorytm Yamamoto i Yuna \cite{2}\cite{3}
\item algorytm z rozszerzonymi funkcjami wyjściowymi\cite{1}
\end{itemize}\vspace{0.2cm}
\section{Struktura układu sterowania}
Obie wersje algorytmu mają identyczną strukturę układu sterowania.
Składa się ona z dwóch pętli sprzężenia zwrotnego, które mają sprowadzić równania manipulatora mobilnego do liniowej postaci $\ddot{y}(t)=\zeta$, gdzie $\zeta$ jest nowym sterowaniem.
\begin{itemize}
\item pętla wewnętrzna - przekształca układ do postaci liniowej typu "podwójny integrator"
\item pętla zewnętrzna - zapewnia realizację zadania tj. śledzenia trajektori w uzyskanym układzie liniowym
\end{itemize}
\section{Odprzęganie według Yamamoto i Yuna}
\subsection{Specyfikacja podejścia}
Yamamoto i Yun założyli, że manipulator ma ustawić się w stałej konfiguracji o maksymalnej manipulowalności, natomiast zadanie jest realizowane głównie przez ruch platformy
\subsection{Algorytm sterowania}
\subsection{Badania symulacyjne}
\section{Odprzęganie z rozszerzonymi funkcjami wyjściowymi}
\subsection{Specyfikacja podejścia}
Odmiennie od podejścia Yamamoto i Yun'a  w tym podejściu nie jest wymagany bezruch manipulatora. Może on czynnie uczestniczyć w realizacji zadania.
\subsection{Algorytm sterowania}
Funkcje wyjściowe mają wtedy postacie\cite{1}:
\begin{equation}
y(q)=\left(
\begin{array}{c}
y_1(q_m,q_r)\\
y_2(q_r)\\
\end{array}
\right),
\end{equation}
gdzie $y_1(q_m,q_r)$ jest wektorem wybranych współrzędnych efektora w podstawowym układzie odniesienia ($X_0$,$Y_0$), a $y_2(q_r)$ to wektor wybranych współrzędnych efektora w lokalnym układzie odniesienia ($X_P$,$Y_P$) związanym ze środkiem masy platformy\cite{1}.\\
Algorytm odsprzęgania wejściowo-wyjściowego dla manipulatorów mobilnych złożony jest z dwóch pętli sprzeżeń zwrotnych\cite{1}:
\begin{itemize}[noitemsep,topsep=0pt]
\item wewnętrznej pętli linearyzującej transformację wejście-stan
\item zewnętrzej pętli linearyzującej transformację wejście-wyjście
\end{itemize}
Wewnętrzna pętla realizuje linearyzacje transformacji wejście-stan i wykorzystuje w tym celu prawo sterowania z rodziny algorytmów 'obliczanych momentów'\cite{1}:
\begin{equation}
\label{eq:petla1}
u=B^{*-1}[C^*z+D^*+Q^*v].
\end{equation}
Zewnętrza pętla zapewnia linearyzacje transformacji wejście-wyjście i jest realizowana za pomocą prawa sterowania\cite{1}:
\begin{equation}
\label{eq:petla2}
v=\Phi^{-1}[-\Phi z+\zeta].
\end{equation}
Macierz $\Phi(q)$ jest następująca \[
\Phi=
\begin{bmatrix}
    \Phi_m       & \Phi_{mr} \\
    0       & \Phi_r  \\
\end{bmatrix}=
\begin{bmatrix}
    \frac{\partial y_1}{\partial q_m} G_m      & \frac{\partial y_1}{\partial q_r}  \\
    0       & \frac{\partial y_2}{\partial q_r} \\
\end{bmatrix}.
\]
Prawo sterowania zewnętrznej pętli (\ref{eq:petla2}) wyprowadza się w następujący sposób:\\
Oblicza się pochodną funkcji wyjściowej $y(q)$ po czasie:
\begin{equation}
\dot{y}(q)=
\left(
\begin{array}{c}
    \frac{\partial y_1}{\partial q_m} \dot{q}_m  + \frac{\partial y_1}{\partial q_r} \dot{q}_r \\
     \frac{\partial y_2}{\partial q_r} \dot{q}_r\\
\end{array}
\right)=
\begin{bmatrix}
    \frac{\partial y_1}{\partial q_m} G_m     & \frac{\partial y_1}{\partial q_r}  \\
    0       & \frac{\partial y_2}{\partial q_r} \\
\end{bmatrix}
\left(
\begin{array}{c}
\eta\\
\dot{q}_r\\
\end{array}
\right)=\Phi(q)z,
\end{equation} 
$\dot{y}(q)$ ponownie różniczkuje się po czasie:
\begin{equation}
\label{eq:1}
\ddot{y}=\dot{\Phi}z+\Phi \dot{z}.
\end{equation} 
Stosując pierwszą pętlę (\ref{eq:petla1}) do modelu (\ref{modelpp}) mamy:
\begin{equation}
\label{eq:2}
\dot{z}=v.
\end{equation}
Po podstawieniu zależności (\ref{eq:2}) do równania (\ref{eq:1}) uzyskamy:
\begin{equation}
\ddot{y}=\dot{\Phi}z+\Phi v.
\end{equation} 
Aby zapewnić linearyzację wejściowo-wyjściową należy więc użyć wejścia:
\begin{equation}
v=\Phi ^{-1}[-\Phi z+\zeta].
\end{equation}
Po zastosowaniu algorytmu otrzymuje się więc funkcje wyjściowe w liniowej postaci:
\begin{equation}
\ddot{y}=\zeta.
\end{equation}
System taki można sterować, na przykład za pomocą regulatora PD z korektą
\begin{equation}
\zeta=\ddot{y}_d(t)-K_d\dot{e}(t)-K_pe(t),
\end{equation}
gdzie $\ddot{y}_d(t)$ - druga pochodna zadanej funckji wejściowej,\\ $e(t)=y_d(t)-y(t)$, $\dot{e}(t)=\dot{y}_d(t)-\dot{y}(t)$ - błąd i jego pochodna,\\ $K_d>0$, $K_p>0$ - nastawy regulacji.
\paragraph{Warunki działania algorytmu}
\par Wyżej przedstawiony algorytm wymaga odwracalności macierzy $\Phi$. Warunek jaki trzeba spełnić aby algorytm funkcjonował jest więc następujący:
\begin{equation}
\text{det}(\Phi)=\text{det}(\Phi_m)\text{det}(\Phi_r)\neq0
\end{equation}
\subsection{Badania symulacyjne}
Rozważany monocykl posiada dwa wejścia (sterowania obu kół), można więc odsprząc dwie współrzędne efektora. Podczas badań postanowiono odsprząc współrzędne $x$ i $y$ efektora w podstawowym układzie odniesienia ($X_0$,$Y_0$). Funckja wyjściowa $y_1(q_m,q_r)$ ma więc postać\\
\begin{center}
$y_1(q_m,q_r)=
\left(
\begin{array}{c}
    x + ac_0 + l_2c_{01} + l_3c_{01}c_3 \\
    y + as_0 + l_2s_{01} + l_3s_{01}c_3\\
\end{array}
\right).$
\end{center}
Funkcja $y_2(q_r)$ to wektor współrzędnych $x$, $y$ i $z$ efektora w układzie środka masy platformy ($X_P$,$Y_P$)\\
\begin{center}
$y_2(q_r)=
\left(
\begin{array}{c}
     a + l_2c_{1} + l_3c_{1}c_3 \\
     l_2s_{1} + l_3s_{1}c_3\\
     s_3l_3+q_2
\end{array}
\right).$
\end{center}
Początkowe położenie platformy było równe $q_m(0)=(x(0),y(0),\theta(0),\phi_1(0),\phi_2(0))=(0,0,0,0,0)$, a początkowa konfiguracja manipulatora była równa $q_r(0)=(q_1(0),q_2(0),q_3(0))=(\frac{\pi}{2},0.2,-\frac{\pi}{2})$. Prędkości początkowe $\dot{q}(0)$ były równe zeru.  \\
Parametry geometryczne ustalono jako: $l_2=0.3$m, $l_3=0.2$m, $a=0.2$m.\\
Funkcje wyjściowe miały więc następujące wartości początkowe 
\begin{center}
$y(q_m(0),q_r(0))=
\left(
\begin{array}{c}
    0.2 \\
     0.3 \\
      0.2 \\
     0.3 \\
     0 \\
\end{array}
\right).$
\end{center}
Wektor pochodnych $\dot{y}$ równy był wektorowi zer.\\
Wybrano  następujące trajektorie zadane $y_d(t)$ 
\begin{center}
$y_d(t)=
\left(
\begin{array}{c}
    2t\\
    -0.3\cos{(2t)}\\
    0.5\\
    -0.3\\
    0.2\\
\end{array}
\right).$
\end{center}
Błąd początkowy $e(t)=y_d(t)-y(t)$ i jego pochodna były więc równe
\begin{center}
$e(0)=
\left(
\begin{array}{c}
   -0.2\\
    -0.6\\
    0.3\\
    -0.6\\
    0.2\\
\end{array}
\right), \hspace{1.5cm}
\dot{e}(0)=
\left(
\begin{array}{c}
    2\\
    0\\
    0\\
    0\\
    0\\
\end{array}
\right).$
\end{center}
W badaniach wykorzystano środowisko Matlab/Simulink. \\
\chapter{Model satelity typu free-floating}
\chapter{Odsprzęganie wejściowo-wyjściowe dla satelity typu free-floating}
\begin{thebibliography}{99}
\bibitem{1} Mazur A. \textit{New approach to designing input-output decoupling controllers for mobile manipulators}. Bull. of the Polish Academy of sciences Tech. Sci. 53(1):31-37, (2005)

\bibitem{2} Yamamoto Y, Yun X. \textit{Coordinating locomotion and manipulation of a mobile manipulator.} IEEE Trans. on Automatic Control, 39(6):1326-1332, (1994)

\bibitem{3} Yamamoto Y, Yun X. \textit{Effect of the dynamic interaction on coordinated control of mobile manipulators.} IEEE Trans. Robotics Automat, 12(5):816-824, (1996)

\bibitem{4} Mazur A, Arent K. \textit{Lecture Notes in Control and Information Sciences}, 335:55-71 (2007)

\bibitem{5} Tchoń K, Jakubiak J. \textit{Acceleration-Driven Kinematics of Mobile Manipulators: An Endogenous Configuration Space Approach}, pp.(469-476),  (2004)

\bibitem{6} M. R. Flannery. \textit{The Enigma of Nonholonomic Constraints.} American Association of Physics Teachers, 73(3):265–272, 2005.
\end{thebibliography}

%\include{bibl}



%\bibliography{bibliografia} % bibliografia.bib

%opcjonalnie może się tu pojawić spis rysunków i tabel
% \listoffigures
% \listoftables
\end{document}
