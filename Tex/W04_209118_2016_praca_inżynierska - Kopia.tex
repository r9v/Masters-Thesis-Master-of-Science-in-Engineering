\documentclass[eng,printmode]{mgr}
\usepackage[MeX]{polski}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} 
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{psfrag}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{supertabular}
\usepackage{array}
\usepackage{tabularx}
\usepackage{hhline}
\usepackage{rev}
%\usepackage{framed}
\usepackage{color}
\usepackage{url}
%\usepackage[notref]{showkeys}
%\usepackage{showlabels}
\usepackage{float}
\usepackage{tikz}
\usepackage{enumitem} 
\usepackage{bm}

\reviewer{dypl}{0.2}{0.2}{0.67}
\reviewer{prof}{0.2}{0.6}{0.2}
\def\bp{\begin{review}[prof]}
\def\ep{\end{review}}
\def\bdypl{\begin{review}[dypl]}
\def\edypl{\end{review}}
\newcommand{\R}{I\!\!R} 
\newtheorem{theorem}{Twierdzenie}[section] 
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newenvironment{myitemize}%
 { \begin{list}{\labelitemi}%
   {
      \setlength{\itemsep}{0mm}%
      \setlength{\topsep}{6pt}%
      \setlength{\leftmargin}{5mm}%
     \setlength{\parsep}{1mm}%
    }
  }
{\end{list}
}
\newcounter{mycount}
\newenvironment{MYenumerate}%
 {\begin{list}{\arabic{mycount}.}%
   {\usecounter{mycount}%
%      \setlength{\topsep}{12pt}%
      \setlength{\topsep}{6pt}%
      \setlength{\itemsep}{0mm}%
      \setlength{\leftmargin}{7mm}%
     \setlength{\parsep}{1mm}%
    }%
 }%
{\end{list}}
\newenvironment{todo}
{
\label{todo}
\color{red} [
}
{]
}

\title{Planowanie ruchu bramkarza sportowego jako kinematyczne zadanie robotyczne}
\engtitle{Planning a goalkeeper's motion as a kinematic task of robotics}

\author{Bernard Malec}
\supervisor{Prof.\ dr hab.\ inż.\ Ignacy Dulęba}


\field{Automatyka i Robotyka (AIR)}
\specialisation{Robotyka (ARR)}

%\includeonly{mch0,mch1,mch2,mch3,mch4,bibl}
%\includeonly{mch3}

\begin{document}
\bibliographystyle{plabbrv} %BibTeX polski styl bibliografii 

% te ozdobniki dodaje się dopiero na końcu 
%\maketitle
%\tableofcontents


\chapter{Model manipulatora mobilnego z manipulatorem}
Manipulator mobilny to platforma mobilna z zamontowanym na niej manipulatorem. Biorąc pod uwagę typ ograniczeń nałożonych na kolejno platformę i manipulator można wydzielić 4 typy manipulatorów mobilnych:
\begin{enumerate}
\item typ (\textit{h,h}) - platforma i manipulator związane są ograniczeniami holonomicznymi,
\item typ (\textit{nh,h}) - na platformę nałożone są ograniczenia nieholonomiczne, natomiast na manipulator ograniczenia holonomiczne,
\item typ (\textit{nh,nh}) - ograniczenia nałożone na platformę i manipulator są nieoholonomiczne. Taki manipulator został przedstawiony w \cite{5},
\item typ (\textit{h,nh}) - na manipulator  nałożone są ograniczenia nieholonomiczne, natomiast na platformę holonomiczne.
\end{enumerate} 
W tym rozdziale przedstawiony zostanie model kinematyki i dynamiki manipulatora mobilnego typu (\textit{nh,h}). W rozważanym manipulatorze platformą jest monocykl, czyli robot mobilny klasy (2,0) natomiast manipulator to RRR - potrójne wahadło. Manipulator został przedstawiony na rys(1)

Niech wektor współrzędnych uogólnionych manipulatora mobilnego przyjmie postać:
\begin{equation}
q=\left(
\begin{array}{c}
q_m\\
q_r\\
\end{array}
\right)\in R^{n+p},
\end{equation}
gdzie $q_m=(x,y,\theta, \phi_1, \phi_2)^T \in R^n$ - wektor współrzędnych uogólnionych platformy mobilnej, $q_r=(q_1,q_2,q_3)^T \in R^p$ - wektor współrzędnych wewnętrznych manipulatora.\\
Do wyprowadzenia równań manipulatora mobilnego wykorzystamy mechanikę Langrange'ą. Lagranżjan L zdefiniowany jest jako różnica pomiędzy energią kinetyczną, a potencjalną układu:
\begin{equation}
L=T-V
\end{equation}
Równania ruchu przy braku sił działających na system są następujące:
\begin{equation}
\label{lagrange}
\frac{d}{dt}\frac{\delta L}{d\dot{q}}-\frac{dL}{dq}=0
\end{equation}
Lewą stronę równania \eqref{lagrange} można przedstawić jako:
\begin{equation}
\label{lagrange2}
\frac{d}{dt}\frac{\delta L}{d\dot{q}}-\frac{dL}{dq}=Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)
\end{equation}
Przy obecności sił zewnętrznych równanie \eqref{lagrange} wygląda następująco:
\begin{equation}
\label{lagrange3}
Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)=F_e
\end{equation}
W naszym przypadku siły zewnętrze $F_e$ są sumą 2 składowych: $F_e=B(q)u+F_{nh}$, gdzie $B(q)u$ to uogólnione siły wejściowe(tj. wywierane na system przez elementy wykonawcze), a $F_{nh}$ to siły więzów nieholonomicznych(tj. siły zapewniające spełnienie ograniczeń nieholonomicznych).\\
\section{Ograniczenia nieholonomiczne}
Do wyprowadzenia modelu systemu z elementami nieholonomicznymi konieczna jest analiza ograniczeń nieholonomicznych. W naszym przypadku platforma manipulatora mobilnego to monocykl, który w założeniu będzie poruszać się bez poślizgu wzdłużnego i poprzecznego.\\
Warunek na brak poślizgu wzdłużnego to:\\
\begin{equation}
\dot{x}\sin(\theta)-\dot{y}\cos(\theta)=0
\end{equation} 
\begin{equation}
\dot{x}\cos(\theta)+\dot{y}\sin(\theta)-L\dot{\theta}R\phi_1=0
\end{equation}
Ograniczenia te są z nieholonomiczne można je przedstawić w postaci Pfaffa:
\begin{equation}
A(q)\dot{q}=0
\end{equation}
Z \cite{5} wiemy, że siła więzów nieholonomicznych równa jest $F_{nh}=A(q)^T\lambda$, gdzie $\lambda$ to wektor mnożników Lagrange'a.\\
Równanie \ref{lagrange3} można teraz zapisać jako:
\begin{equation}
\label{lagrange4}
Q(q)\ddot{q}+C(q,\dot{q})\dot{q}+D(q)=A(q)^T\lambda +Bu
\end{equation}
\begin{equation}
\label{eq:dAlambert}
\bm{Q}(q)\ddot{q}+\bm{Q_m}(q)\ddot{q}+\bm{C}(q,\dot{q})\dot{q}+\bm{C_m}(q,\dot{q})\dot{q}+\bm{D}(q)=\bm{A}^T(q)\lambda +\bm{B}(q)u
\end{equation}
Dynamikę \ref{eq:dAlambert} można przedstawić bardziej szczegółowo:
\begin{multline}
\label{eq:dAlambert2}
\begin{bmatrix}
    \bm{Q_{11}}(q)+\bm{Q_m}(q_m)  & \bm{Q_{12}}(q) &  \\
    \bm{Q_{21}}(q)      & \bm{Q_{21}}(q_r) 
\end{bmatrix}
\left(
\begin{array}{c}
\ddot{q_m}\\
\ddot{q_r}\\
\end{array}\right)+\\+
\begin{bmatrix}
    \bm{C_{11}}(q,\dot{q})+\bm{C_m}(q_m,\dot{q}_m) & \bm{C_{12}}(q,\dot{q}) &  \\
    \bm{C_{21}}(q,\dot{q})  & \bm{C_{21}}(q_r,\dot{q}_r) 
\end{bmatrix} 
\left(
\begin{array}{c}
\dot{q_m}\\
\dot{q_r}\\
\end{array}
\right)
+
\left(
\begin{array}{c}
0\\
\bm{D}(q_r)\\
\end{array}\right)
=\\=
\left(
\begin{array}{c}
\bm{A}^T(q_m)\lambda\\
0\\
\end{array}\right) +
\left(
\begin{array}{c}
\bm{B}(q_m)u_m\\
u_r\\
\end{array}\right),
\end{multline}
gdzie:
\begin{equation}
\bm{Q}(q)=\begin{bmatrix}
    \bm{Q_{11}}(q)  & \bm{Q_{12}}(q) &  \\
    \bm{Q_{21}}(q)      & \bm{Q_{21}}(q_r) 
\end{bmatrix}
\end{equation}

\begin{equation}
\bm{Q_m}(q)=\begin{bmatrix}
    \bm{Q_{m}}(q_m)  & \bm{0} &  \\
    \bm{0}     & \bm{0}
\end{bmatrix}
\end{equation}

\begin{equation}
\bm{C}(q)=\begin{bmatrix}
   \bm{C_{11}}(q,\dot{q}) & \bm{C_{12}}(q,\dot{q}) &  \\
    \bm{C_{21}}(q,\dot{q})  & \bm{C_{21}}(q_r,\dot{q}_r) 
\end{bmatrix}
\end{equation}

\begin{equation}
\bm{C_m}(q)=\begin{bmatrix}
   \bm{C_{m}}(q_m,\dot{q}_m) & \bm{0} &  \\
    \bm{0}  & \bm{0}) 
\end{bmatrix}
\end{equation}
\begin{equation}
\bm{D}(q)=\left(
\begin{array}{c}
0\\
\bm{D}(q_r)\\
\end{array}\right)
\end{equation}
\begin{equation}
\lambda \in R^l \bm{A}^T(q_m)\lambda - wektor sił wiążów ograniczeń
\end{equation}

\begin{equation}
\bm{B}(q)=\left(
\begin{array}{c}
\bm{B}(q_m)\\
0\\
\end{array}\right),
\end{equation}
\begin{equation}
u=\left(
\begin{array}{c}
u_m\\
u_r\\
\end{array}\right),
\end{equation}
\begin{equation}
\label{eq:model}
\bm{Q}^*\dot{z}+\bm{C}^*z+\bm{D}^*=\bm{B}^*u
\end{equation}
\begin{equation}
z=\left(
\begin{array}{c}
\eta\\
\dot{q}_r\\
\end{array}
\right)
\end{equation}
Należy wyelminować mnożniki Lagrange'a z równania. W tym celu znajdziemy zbiór baz jądra $A$. Wtedy macierz $G=[g_1,g2,....,g_m]$ spełnia
\begin{equation}
A(q)G(q)=0
\end{equation}
%$G(q_m)$ macierz spełniająca $A(q_m)G(q_m)=0$.
\section{Odsprzęganie wejściowo-wyjściowe dla platformy mobilnej z manipulatorem}
Algorytm odsprzęgania wejściowo-wyjściowego jest wykorzystywany do sterowania manipulatorów mobilnych. Rozwiązuje on zadanie śledzenia zadanej trajektorii efektora $y_d(t)$ w przestrzeni zewnętrznej. Polega on na zastosowaniu dwóch pętli sprzężenia zwrotnego, aby sprowadzić równania manipulatora mobilnego do liniowej postaci $\ddot{y}(t)=\zeta$, gdzie $\zeta$ jest nowym sterowaniem. Algorytm odpsprzęgania wejściowo-wyjściowego wymaga pełnej znajomości modelu manipulatora mobilnego.\\ 

 \noindent Istnieją dwie wersje tego algorytmu dla manipulatorów mobilnych (\textit{nh},\textit{h}):
\begin{itemize}[noitemsep,topsep=0pt]
\item oryginalny algorytm Yamamoto i Yuna \cite{2}\cite{3}
\item algorytm z rozszerzonymi funkcjami wyjściowymi\cite{1}
\end{itemize}\vspace{0.2cm}
W tej pracy użyto algorytmu z rozszerzonymi funkcjami wyjściowymi. Funkcje wyjściowe mają wtedy postacie\cite{1}:
\begin{equation}
y(q)=\left(
\begin{array}{c}
y_1(q_m,q_r)\\
y_2(q_r)\\
\end{array}
\right),
\end{equation}
gdzie $y_1(q_m,q_r)$ jest wektorem wybranych współrzędnych efektora w podstawowym układzie odniesienia ($X_0$,$Y_0$), a $y_2(q_r)$ to wektor wybranych współrzędnych efektora w lokalnym układzie odniesienia ($X_P$,$Y_P$) związanym ze środkiem masy\cite{1}.\\
Algorytm odsprzęgania wejściowo-wyjściowego dla manipulatorów mobilnych złożony jest z dwóch pętli sprzeżeń zwrotnych\cite{1}:
\begin{itemize}[noitemsep,topsep=0pt]
\item wewnętrznej pętli linearyzującej transformację wejście-stan
\item zewnętrzej pętli linearyzującej transformację wejście-wyjście
\end{itemize}
Wewnętrzna pętla realizuje linearyzacje transformacji wejście-stan i wykorzystuje w tym celu prawo sterowania z rodziny algorytmów 'obliczanych momentów'\cite{1}:
\begin{equation}
\label{eq:petla1}
u=\bm{B}^{*-1}[\bm{C}^*z+\bm{D}^*+\bm{Q}^*v].
\end{equation}
Zewnętrza pętla zapewnia linearyzacje transformacji wejście-wyjście i jest realizowana za pomocą prawa sterowania\cite{1}:
\begin{equation}
\label{eq:petla2}
v=\bm{\Phi} ^{-1}[-\bm{\Phi} z+\zeta].
\end{equation}
Macierz $\bm{\Phi}(q)$ jest następująca \[
\bm{\Phi}=
\begin{bmatrix}
    \bm{\Phi}_m       & \bm{\Phi}_{mr} \\
    0       & \bm{\Phi}_r  \\
\end{bmatrix}=
\begin{bmatrix}
    \frac{\partial y_1}{\partial q_m} \bm{G  }    & \frac{\partial y_1}{\partial q_r}  \\
    0       & \frac{\partial y_2}{\partial q_r} \\
\end{bmatrix}.
\]
Prawo sterowania zewnętrznej pętli (\ref{eq:petla2}) wyprowadza się w następujący sposób:\\
Oblicza się pochodną funkcji wyjściowej $y(q)$ po czasie:
\begin{equation}
\dot{y}(q)=
\left(
\begin{array}{c}
    \frac{\partial y_1}{\partial q_m} \dot{q_m}  + \frac{\partial y_1}{\partial q_r} \dot{q_r} \\
     \frac{\partial y_2}{\partial q_r} \dot{q_r}\\
\end{array}
\right)=
\begin{bmatrix}
    \frac{\partial y_1}{\partial q_m} \bm{G}     & \frac{\partial y_1}{\partial q_r}  \\
    0       & \frac{\partial y_2}{\partial q_r} \\
\end{bmatrix}
\left(
\begin{array}{c}
\eta\\
\dot{q}_r\\
\end{array}
\right)=\bm{\Phi}(q)z,
\end{equation} 
$\dot{y}(q)$ ponownie różniczkuje się po czasie:
\begin{equation}
\label{eq:1}
\ddot{y}=\dot{\bm{\Phi}}z+\bm{\Phi} \dot{z}.
\end{equation} 
Stosując pierwszą pętlę (\ref{eq:petla1}) do modelu (\ref{eq:model}) mamy:
\begin{equation}
\label{eq:2}
\dot{z}=v.
\end{equation}
Po podstawieniu zależności (\ref{eq:2}) do równania (\ref{eq:1}) uzyskamy:
\begin{equation}
\ddot{y}=\dot{\bm{\Phi}}z+\bm{\Phi} v.
\end{equation} 
Aby zapewnić linearyzację wejściowo-wyjściową należy więc użyć wejścia:
\begin{equation}
v=\bm{\Phi} ^{-1}[-\bm{\Phi} z+\zeta].
\end{equation}
\subsection{Warunki działania algorytmu}
Wyżej przedstawiony algorytm wymaga odwracalności macierzy $\bm{\Phi}$. Warunek jaki trzeba spełnić aby algorytm funkcjonował jest więc następujący:
\begin{equation}
\text{det}(\bm{\Phi})=\text{det}(\bm{\Phi}_m)\text{det}(\bm{\Phi}_r)\neq0
\end{equation}

\begin{thebibliography}{99}
\bibitem{1} Mazur A. \textit{New approach to designing input-output decoupling
controllers for mobile manipulators}. Bulettin of the Polish Academy of Science vol. 53, no. 1 (2005)

\bibitem{2} Yamamoto Y, Yun X. \textit{Coordinating locomotion and manipulation of a mobile manipulator.} IEEE Trans. on Automatic Control, vol. 39, no. 6 (1994)

\bibitem{3} Yamamoto Y, Yun X. \textit{Effect of the dynamic interaction on coordinated control of mobile manipulators.} IEEE Trans. on Robotics and Automation, vol. 12, no. 5 (1996)

\bibitem{4} Mazur A, Arent K. \textit{Lecture Notes in Control and Information Sciences, vol. 335, strony 55-71.} IEEE Trans. on Robotics and Automation, vol. 12, no. 5 (2007)

\bibitem{5} Tchoń K, Jakubiak J. \textit{Acceleration-driven kinematics of mobile manipulators: an endogenous configuration space approach w: J. Lenarcic, C. Galletti (Eds.) On Advances in Robot Kinematics.} Kluwer Academic Publishers, The Netherlands (2004)

\bibitem{5} M. R. Flannery. \textit{The Enigma of Nonholonomic Constraints.} American Association of Physics Teachers, 73(3):265–272, 2005.
\end{thebibliography}

%\include{bibl}



%\bibliography{bibliografia} % bibliografia.bib

%opcjonalnie może się tu pojawić spis rysunków i tabel
% \listoffigures
% \listoftables
\end{document}
