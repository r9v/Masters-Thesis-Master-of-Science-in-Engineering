(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31909,        736]
NotebookOptionsPosition[     31006,        703]
NotebookOutlinePosition[     31381,        719]
CellTagsIndexPosition[     31338,        716]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Derivative", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0", " ", "=", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st1", "=", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "+", "q1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st12", "=", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "+", "q1", "+", "q2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c0", " ", "=", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ct1", "=", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "+", "q1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ct12", "=", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "+", "q1", "+", "q2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xe", "=", 
   RowBox[{"(", 
    RowBox[{"xbar", "+", 
     RowBox[{
      FractionBox[
       RowBox[{"m1", " "}], 
       RowBox[{"mb", "+", "m1", " ", "+", "m2", " "}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c0", " ", "a"}], "-", 
        RowBox[{"s0", " ", "b"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"l1", " "}], "2"], "ct1"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"m2", " "}], 
       RowBox[{"mb", "+", "m1", " ", "+", "m2", " "}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c0", " ", "a"}], "-", 
        RowBox[{"s0", " ", "b"}], "+", 
        RowBox[{"l1", "  ", "ct1"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"l2", " "}], "2"], "ct12"}]}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ye", "=", 
    RowBox[{"(", 
     RowBox[{"ybar", "+", 
      RowBox[{
       FractionBox[
        RowBox[{"m1", " "}], 
        RowBox[{"mb", "+", "m1", " ", "+", "m2", " "}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s0", " ", "a"}], "+", 
         RowBox[{"c0", " ", "b"}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"l1", " "}], "2"], "st1"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"m2", " "}], 
        RowBox[{"mb", "+", "m1", " ", "+", "m2", " "}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s0", " ", "a"}], "+", 
         RowBox[{"c0", " ", "b"}], "+", 
         RowBox[{"l1", "  ", "st1"}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"l2", " "}], "2"], "st12"}]}], ")"}]}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xepp1", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", 
          RowBox[{"{", 
           RowBox[{"xbar", ",", "2"}], "}"}]}], "]"}], 
        SuperscriptBox["xbarp", "2"]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", 
          RowBox[{"{", 
           RowBox[{"ybar", ",", "2"}], "}"}]}], "]"}], 
        SuperscriptBox["ybarp", "2"]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "2"}], "}"}]}], "]"}], 
        SuperscriptBox["\[Theta]p", "2"]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "2"}], "}"}]}], "]"}], 
        SuperscriptBox["q1p", "2"]}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", 
          RowBox[{"{", 
           RowBox[{"q2", ",", "2"}], "}"}]}], "]"}], 
        SuperscriptBox["q2p", "2"]}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", "xbar"}], "]"}], "xbarpp"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", "ybar"}], "]"}], "ybarpp"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", "\[Theta]"}], "]"}], "\[Theta]pp"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", "q1"}], "]"}], "q1pp"}], "+", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"xe", ",", "q2"}], "]"}], "q2pp"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yepp1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", 
         RowBox[{"{", 
          RowBox[{"xbar", ",", "2"}], "}"}]}], "]"}], 
       SuperscriptBox["xbarp", "2"]}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", 
         RowBox[{"{", 
          RowBox[{"ybar", ",", "2"}], "}"}]}], "]"}], 
       SuperscriptBox["ybarp", "2"]}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "2"}], "}"}]}], "]"}], 
       SuperscriptBox["\[Theta]p", "2"]}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", "2"}], "}"}]}], "]"}], 
       SuperscriptBox["q1p", "2"]}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", 
         RowBox[{"{", 
          RowBox[{"q2", ",", "2"}], "}"}]}], "]"}], 
       SuperscriptBox["q2p", "2"]}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", "xbar"}], "]"}], "xbarpp"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", "ybar"}], "]"}], "ybarpp"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", "\[Theta]"}], "]"}], "\[Theta]pp"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", "q1"}], "]"}], "q1pp"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", "q2"}], "]"}], "q2pp"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.7357115057283363`*^9, 3.735711576202367*^9}, {
   3.735711807098573*^9, 3.735711833666093*^9}, {3.7358145413721104`*^9, 
   3.7358145417951345`*^9}, 3.7358147105467863`*^9, {3.7358149414609942`*^9, 
   3.7358149510815444`*^9}, {3.7358149845944614`*^9, 
   3.7358150319281683`*^9}, {3.735815450173091*^9, 3.7358154506771193`*^9}, {
   3.735815922139824*^9, 3.7358159816618214`*^9}, {3.7358161629189167`*^9, 
   3.735816220289335*^9}, {3.735817428386301*^9, 3.7358174719037905`*^9}, {
   3.7358175636400375`*^9, 3.7358176370372353`*^9}, {3.7358187501593666`*^9, 
   3.7358188554617724`*^9}, {3.735818906482362*^9, 3.735818936370273*^9}, {
   3.7358190950736847`*^9, 3.735819268328944*^9}, {3.735820405675513*^9, 
   3.7358204057067127`*^9}, {3.7358204585801163`*^9, 
   3.7358204658833427`*^9}, {3.7358205054738894`*^9, 3.735820582756818*^9}, {
   3.7358206341320143`*^9, 3.735820659491314*^9}, {3.735822144004311*^9, 
   3.7358221605513844`*^9}, {3.735824289755473*^9, 3.735824291058276*^9}, 
   3.7358256203535013`*^9, 3.7358270032028046`*^9, 3.73582853926387*^9, {
   3.735828728422689*^9, 3.735828736268138*^9}, {3.735828824911208*^9, 
   3.735828842745228*^9}, {3.7358289325513644`*^9, 3.735828934246462*^9}, {
   3.7358291765163183`*^9, 3.7358291830936947`*^9}, {3.7358295838413696`*^9, 
   3.7358296513885574`*^9}, {3.735829806451408*^9, 3.7358298412529054`*^9}, {
   3.7359034405397654`*^9, 3.735903517431163*^9}, {3.7359035528401885`*^9, 
   3.7359035782476416`*^9}, {3.7359042821388383`*^9, 
   3.7359042831068935`*^9}, {3.7359043380150337`*^9, 3.735904350810766*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "xbar", "}"}], ",", 
       RowBox[{"{", "ybar", "}"}], ",", 
       RowBox[{"{", "\[Theta]", "}"}], ",", 
       RowBox[{"{", "q1", "}"}], ",", 
       RowBox[{"{", "q2", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "xbarp", "}"}], ",", 
       RowBox[{"{", "ybarp", "}"}], ",", 
       RowBox[{"{", "\[Theta]p", "}"}], ",", 
       RowBox[{"{", "q1p", "}"}], ",", 
       RowBox[{"{", "q2p", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qpp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "xbarpp", "}"}], ",", 
       RowBox[{"{", "ybarpp", "}"}], ",", 
       RowBox[{"{", "\[Theta]pp", "}"}], ",", 
       RowBox[{"{", "q1pp", "}"}], ",", 
       RowBox[{"{", "q2pp", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xepp2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "qp", "]"}], ".", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"xe", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "[", "q", "]"}], ",", "2"}], "}"}]}], "]"}],
          ",", "1"}], "]"}], ".", "qp"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"xe", ",", 
         RowBox[{"Transpose", "[", "q", "]"}]}], "]"}], ".", "qpp"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yepp2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "qp", "]"}], ".", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"ye", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "[", "q", "]"}], ",", "2"}], "}"}]}], "]"}],
          ",", "1"}], "]"}], ".", "qp"}], "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"ye", ",", 
         RowBox[{"Transpose", "[", "q", "]"}]}], "]"}], ".", "qpp"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.7357115057283363`*^9, 3.735711576202367*^9}, {
   3.735711807098573*^9, 3.735711833666093*^9}, {3.7358145413721104`*^9, 
   3.7358145417951345`*^9}, 3.7358147105467863`*^9, {3.7358149414609942`*^9, 
   3.7358149510815444`*^9}, {3.7358149845944614`*^9, 
   3.7358150319281683`*^9}, {3.735815450173091*^9, 3.7358154506771193`*^9}, {
   3.735815922139824*^9, 3.7358159816618214`*^9}, {3.7358161629189167`*^9, 
   3.735816220289335*^9}, {3.735817428386301*^9, 3.7358174719037905`*^9}, {
   3.7358175636400375`*^9, 3.7358176370372353`*^9}, {3.7358187501593666`*^9, 
   3.7358188554617724`*^9}, {3.735818906482362*^9, 3.735818936370273*^9}, {
   3.7358190950736847`*^9, 3.735819268328944*^9}, {3.735820405675513*^9, 
   3.7358204057067127`*^9}, {3.7358204585801163`*^9, 
   3.7358204658833427`*^9}, {3.7358205054738894`*^9, 3.735820582756818*^9}, {
   3.7358206341320143`*^9, 3.735820659491314*^9}, {3.735822144004311*^9, 
   3.7358221605513844`*^9}, {3.735824289755473*^9, 3.735824291058276*^9}, 
   3.7358256203535013`*^9, 3.7358270032028046`*^9, 3.73582853926387*^9, {
   3.735828728422689*^9, 3.735828736268138*^9}, {3.735828824911208*^9, 
   3.735828842745228*^9}, {3.7358289325513644`*^9, 3.735828934246462*^9}, {
   3.7358291765163183`*^9, 3.7358291830936947`*^9}, {3.7358295838413696`*^9, 
   3.7358296513885574`*^9}, {3.735829806451408*^9, 3.7358298412529054`*^9}, {
   3.7359034405397654`*^9, 3.735903517431163*^9}, {3.7359035528401885`*^9, 
   3.735903578185638*^9}, {3.7359036124936*^9, 3.7359037575168953`*^9}, {
   3.735903790884804*^9, 3.7359037997493105`*^9}, {3.7359038539274096`*^9, 
   3.735903882132023*^9}, {3.735903955195202*^9, 3.7359040157386646`*^9}, {
   3.7359044259290624`*^9, 3.7359044369846945`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.735903972667201*^9, 3.7359044640072403`*^9}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.7357115057283363`*^9, 3.735711576202367*^9}, {
   3.735711807098573*^9, 3.735711833666093*^9}, {3.7358145413721104`*^9, 
   3.7358145417951345`*^9}, 3.7358147105467863`*^9, {3.7358149414609942`*^9, 
   3.7358149510815444`*^9}, {3.7358149845944614`*^9, 
   3.7358150319281683`*^9}, {3.735815450173091*^9, 3.7358154506771193`*^9}, {
   3.735815922139824*^9, 3.7358159816618214`*^9}, {3.7358161629189167`*^9, 
   3.735816220289335*^9}, {3.735817428386301*^9, 3.7358174719037905`*^9}, {
   3.7358175636400375`*^9, 3.7358176370372353`*^9}, {3.7358187501593666`*^9, 
   3.7358188554617724`*^9}, {3.735818906482362*^9, 3.735818936370273*^9}, {
   3.7358190950736847`*^9, 3.735819268328944*^9}, {3.735820405675513*^9, 
   3.7358204057067127`*^9}, {3.7358204585801163`*^9, 
   3.7358204658833427`*^9}, {3.7358205054738894`*^9, 3.735820582756818*^9}, {
   3.7358206341320143`*^9, 3.735820659491314*^9}, {3.735822144004311*^9, 
   3.7358221605513844`*^9}, {3.735824289755473*^9, 3.735824291058276*^9}, 
   3.7358256203535013`*^9, 3.7358270032028046`*^9, 3.73582853926387*^9, {
   3.735828728422689*^9, 3.735828736268138*^9}, {3.735828824911208*^9, 
   3.735828842745228*^9}, {3.7358289325513644`*^9, 3.735828934246462*^9}, {
   3.7358291765163183`*^9, 3.7358291830936947`*^9}, {3.7358295838413696`*^9, 
   3.7358296513885574`*^9}, {3.735829806451408*^9, 3.7358298412529054`*^9}, {
   3.7359034405397654`*^9, 3.735903517431163*^9}, {3.7359035528401885`*^9, 
   3.735903578185638*^9}, {3.7359036124936*^9, 3.7359037575168953`*^9}, {
   3.735903790884804*^9, 3.7359037997493105`*^9}, {3.7359038539274096`*^9, 
   3.7359039383072357`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "D","dvar",
   "\"Multiple derivative specifier \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"xbar\\\", \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", \\\"ybar\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"\[Theta]\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"q1\\\", \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"q2\\\", \\\"}\\\"}]}], \\\"}\\\
\"}]\\) does not have the form {variable, n}, where n is a non-negative \
machine integer.\"",2,92,16,18909605975302358638,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.735903808719824*^9, {3.735903869166281*^9, 3.7359039133348074`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "xbar", "}"}], ",", 
     RowBox[{"{", "ybar", "}"}], ",", 
     RowBox[{"{", "\[Theta]", "}"}], ",", 
     RowBox[{"{", "q1", "}"}], ",", 
     RowBox[{"{", "q2", "}"}]}], "}"}]], 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]], "Output",
 CellChangeTimes->{{3.7359038838021183`*^9, 3.735903913364809*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rls", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Dt", "[", "m1", "]"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "m2", "]"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "mb", "]"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "a", "]"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "b", "]"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "l2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "l1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "l1", "]"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "q1", "]"}], "\[Rule]", " ", "q1p"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "q2", "]"}], "\[Rule]", " ", "q2p"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "\[Theta]", "]"}], "\[Rule]", " ", "\[Theta]p"}], 
     ",", 
     RowBox[{
      RowBox[{"Dt", "[", "xbar", "]"}], "\[Rule]", " ", "xbarp"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "ybar", "]"}], "\[Rule]", " ", "ybarp"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "q1p", "]"}], "\[Rule]", " ", "q1pp"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "q2p", "]"}], "\[Rule]", " ", "q2pp"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "\[Theta]p", "]"}], "\[Rule]", " ", "\[Theta]pp"}], 
     ",", 
     RowBox[{
      RowBox[{"Dt", "[", "xbarp", "]"}], "\[Rule]", " ", "xbarpp"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", "ybarp", "]"}], "\[Rule]", " ", "ybarpp"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtx", "=", 
   RowBox[{
    RowBox[{"Dt", "[", "xe", "]"}], "/.", "rls"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dty", "=", 
   RowBox[{
    RowBox[{"Dt", "[", "ye", "]"}], "/.", "rls"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtx2", "=", 
   RowBox[{
    RowBox[{"Dt", "[", "dtx", "]"}], "/.", "rls"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dty2", "=", 
   RowBox[{
    RowBox[{"Dt", "[", "dty", "]"}], "/.", "rls"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.7357115057283363`*^9, 3.735711576202367*^9}, {
   3.735711807098573*^9, 3.735711833666093*^9}, {3.7358145413721104`*^9, 
   3.7358145417951345`*^9}, 3.7358147105467863`*^9, {3.7358149414609942`*^9, 
   3.7358149510815444`*^9}, {3.7358149845944614`*^9, 
   3.7358150319281683`*^9}, {3.735815450173091*^9, 3.7358154506771193`*^9}, {
   3.735815922139824*^9, 3.7358159816618214`*^9}, {3.7358161629189167`*^9, 
   3.735816220289335*^9}, {3.735817428386301*^9, 3.7358174719037905`*^9}, {
   3.7358175636400375`*^9, 3.7358176370372353`*^9}, {3.7358187501593666`*^9, 
   3.7358188554617724`*^9}, {3.735818906482362*^9, 3.735818936370273*^9}, {
   3.7358190950736847`*^9, 3.735819268328944*^9}, {3.735820405675513*^9, 
   3.7358204057067127`*^9}, {3.7358204585801163`*^9, 
   3.7358204658833427`*^9}, {3.7358205054738894`*^9, 3.735820582756818*^9}, {
   3.7358206341320143`*^9, 3.735820659491314*^9}, {3.735822144004311*^9, 
   3.7358221605513844`*^9}, {3.735824289755473*^9, 3.735824291058276*^9}, 
   3.7358256203535013`*^9, 3.7358270032028046`*^9, {3.73582853926387*^9, 
   3.7358286621028957`*^9}, {3.735828803015956*^9, 3.735828807221196*^9}, {
   3.735828898628424*^9, 3.735828917589509*^9}, {3.735828990476678*^9, 
   3.7358291831066957`*^9}, 3.735829245758279*^9, {3.735829327794442*^9, 
   3.735829411921084*^9}, {3.7358294573990135`*^9, 3.7358295454054627`*^9}, {
   3.7358295838881702`*^9, 3.735829625528087*^9}, {3.7358297506390533`*^9, 
   3.7358297816083403`*^9}, {3.73582989095345*^9, 3.73582994840761*^9}, {
   3.7358299807365227`*^9, 3.7358301182245264`*^9}, {3.7358301496580257`*^9, 
   3.735830255255538*^9}, {3.735903440612769*^9, 3.7359035343701315`*^9}, {
   3.735904603184201*^9, 3.735904666925847*^9}, {3.735904763246356*^9, 
   3.7359048215496907`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"xepp1", "-", "dtx2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"yepp1", "-", "dty2"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.7357115057283363`*^9, 3.735711576202367*^9}, {
   3.735711807098573*^9, 3.735711833666093*^9}, {3.7358145413721104`*^9, 
   3.7358145417951345`*^9}, 3.7358147105467863`*^9, {3.7358149414609942`*^9, 
   3.7358149510815444`*^9}, {3.7358149845944614`*^9, 
   3.7358150319281683`*^9}, {3.735815450173091*^9, 3.7358154506771193`*^9}, {
   3.735815922139824*^9, 3.7358159816618214`*^9}, {3.7358161629189167`*^9, 
   3.735816220289335*^9}, {3.735817428386301*^9, 3.7358174719037905`*^9}, {
   3.7358175636400375`*^9, 3.7358176370372353`*^9}, {3.7358187501593666`*^9, 
   3.7358188554617724`*^9}, {3.735818906482362*^9, 3.735818936370273*^9}, {
   3.7358190950736847`*^9, 3.735819268328944*^9}, {3.735820405675513*^9, 
   3.7358204057067127`*^9}, {3.7358204585801163`*^9, 
   3.7358204658833427`*^9}, {3.7358205054738894`*^9, 3.735820582756818*^9}, {
   3.7358206341320143`*^9, 3.735820659491314*^9}, {3.735822144004311*^9, 
   3.7358221605513844`*^9}, {3.735824289755473*^9, 3.735824291058276*^9}, 
   3.7358256203535013`*^9, 3.7358270032028046`*^9, {3.73582853926387*^9, 
   3.7358286621028957`*^9}, {3.735828803015956*^9, 3.735828807221196*^9}, {
   3.735828898628424*^9, 3.735828917589509*^9}, {3.735828990476678*^9, 
   3.7358291831066957`*^9}, 3.735829245758279*^9, {3.735829327794442*^9, 
   3.735829411921084*^9}, {3.7358294573990135`*^9, 3.7358295454054627`*^9}, {
   3.7358295838881702`*^9, 3.735829625528087*^9}, {3.7358297506390533`*^9, 
   3.7358297816083403`*^9}, {3.73582989095345*^9, 3.73582994840761*^9}, {
   3.7358299807365227`*^9, 3.7358301182245264`*^9}, {3.7358301496580257`*^9, 
   3.735830255255538*^9}, {3.735903440612769*^9, 3.7359035343701315`*^9}, 
   3.7359035781926384`*^9, {3.7359046531040564`*^9, 3.735904654518137*^9}, {
   3.735904771861849*^9, 3.7359047854536257`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"m1", "+", "m2", "+", "mb"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"l1", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", "q1p", " ", "\[Theta]p", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "+", "\[Theta]"}], "]"}]}], "+", 
    RowBox[{"l2", " ", "m2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2p", " ", "\[Theta]p"}], "+", 
       RowBox[{"q1p", " ", 
        RowBox[{"(", 
         RowBox[{"q2p", "+", "\[Theta]p"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "+", "q2", "+", "\[Theta]"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.735904470696623*^9, 3.735904730131462*^9, 
  3.735904829069121*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"m1", "+", "m2", "+", "mb"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"l1", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", "q1p", " ", "\[Theta]p", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"q1", "+", "\[Theta]"}], "]"}]}], "+", 
    RowBox[{"l2", " ", "m2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2p", " ", "\[Theta]p"}], "+", 
       RowBox[{"q1p", " ", 
        RowBox[{"(", 
         RowBox[{"q2p", "+", "\[Theta]p"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"q1", "+", "q2", "+", "\[Theta]"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.735904470696623*^9, 3.735904730131462*^9, 
  3.7359048300901794`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"xepp2", "-", "dtx2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"yepp2", "-", "dty2"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.735903535958223*^9, 3.7359035366702633`*^9}, 
   3.735903578203639*^9, {3.7359046565832553`*^9, 3.7359046579353323`*^9}, {
   3.7359047904069095`*^9, 3.7359047942781305`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.735904501500385*^9, 3.73590470072478*^9, 
  3.7359048261609545`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.735904501500385*^9, 3.73590470072478*^9, 
  3.735904826173955*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"xepp3", "-", 
    RowBox[{"Dt", "[", "dtx", "]"}]}], "/.", "rls"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"yepp3", "-", 
    RowBox[{"Dt", "[", "dty", "]"}]}], "/.", "rls"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7359035378383303`*^9, 3.735903538814386*^9}, 
   3.7359035782106395`*^9, {3.735904661070512*^9, 3.7359046625185947`*^9}}]
},
WindowSize->{784, 812},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9163, 238, 784, "Input"],
Cell[9724, 260, 5312, 110, 240, "Input"],
Cell[15039, 372, 92, 1, 39, "Input"],
Cell[CellGroupData[{
Cell[15156, 377, 3058, 43, 39, "Input"],
Cell[18217, 422, 674, 12, 54, "Message"],
Cell[18894, 436, 446, 12, 41, "Output"]
}, Open  ]],
Cell[19355, 451, 5366, 108, 265, "Input"],
Cell[CellGroupData[{
Cell[24746, 563, 3420, 49, 90, "Input"],
Cell[28169, 614, 776, 23, 81, "Output"],
Cell[28948, 639, 778, 23, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29763, 667, 414, 7, 90, "Input"],
Cell[30180, 676, 163, 4, 39, "Output"],
Cell[30346, 682, 161, 4, 39, "Output"]
}, Open  ]],
Cell[30522, 689, 480, 12, 90, "Input"]
}
]
*)

