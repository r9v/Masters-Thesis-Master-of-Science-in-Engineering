(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80289,       2277]
NotebookOptionsPosition[     79474,       2247]
NotebookOutlinePosition[     79852,       2263]
CellTagsIndexPosition[     79809,       2260]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Derivative", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"axis_", ",", "angle_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"axis", ",", "`X", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Sin", "[", "angle", "]"}]}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Sin", "[", "angle", "]"}], ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
          "]"}], ",", "`Y", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0", ",", 
              RowBox[{"Sin", "[", "angle", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Sin", "[", "angle", "]"}]}], ",", "0", ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
          "]"}], ",", "`Z", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "angle", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Sin", "[", "angle", "]"}]}], ",", "0", ",", "0"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sin", "[", "angle", "]"}], ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0", ",", "0"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
          "]"}]}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"axis_", ",", "sh_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mac", "=", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"axis", ",", "`X", ",", 
         RowBox[{
          RowBox[{"mac", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}], "=", "sh"}], ",", "`Y", 
         ",", 
         RowBox[{
          RowBox[{"mac", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", "sh"}], ",", "`Z", 
         ",", 
         RowBox[{
          RowBox[{"mac", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "4"}], "]"}], "]"}], "=", "sh"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "mac", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["s", "0"], "=", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["s", "t1"], "=", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "+", 
     SubscriptBox["q", "1"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["s", "t12"], "=", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "+", 
     SubscriptBox["q", "1"], "+", 
     SubscriptBox["q", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["c", "0"], "=", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["c", "t1"], "=", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "+", 
     SubscriptBox["q", "1"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["c", "t12"], "=", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "+", 
      SubscriptBox["q", "1"], "+", 
      SubscriptBox["q", "2"]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "b0"], "=", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"X", ",", 
      SubscriptBox["x", "b"]}], "]"}], ".", 
    RowBox[{"T", "[", 
     RowBox[{"Y", ",", 
      SubscriptBox["y", "b"]}], "]"}], ".", 
    RowBox[{"R", "[", 
     RowBox[{"Z", ",", "\[Theta]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "10"], "=", 
   RowBox[{
    SubscriptBox["A", "b0"], ".", 
    RowBox[{"T", "[", 
     RowBox[{"X", ",", "a"}], "]"}], ".", 
    RowBox[{"T", "[", 
     RowBox[{"Y", ",", "b"}], "]"}], ".", 
    RowBox[{"R", "[", 
     RowBox[{"Z", ",", 
      SubscriptBox["q", "1"]}], "]"}], ".", 
    RowBox[{"T", "[", 
     RowBox[{"X", ",", 
      SubscriptBox["l", "1"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["A", "20"], "=", 
    RowBox[{
     SubscriptBox["A", "10"], ".", 
     RowBox[{"R", "[", 
      RowBox[{"Z", ",", 
       SubscriptBox["q", "2"]}], "]"}], ".", 
     RowBox[{"T", "[", 
      RowBox[{"X", ",", 
       SubscriptBox["l", "2"]}], "]"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["A", "."], "b0"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", 
       SubscriptBox["x", "b"]}], "]"}], 
     SubscriptBox[
      OverscriptBox["x", "."], "b"]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", 
       SubscriptBox["y", "b"]}], "]"}], 
     SubscriptBox[
      OverscriptBox["y", "."], "b"]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", "\[Theta]"}], "]"}], 
     OverscriptBox["\[Theta]", "."]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", 
       SubscriptBox["q", "1"]}], "]"}], 
     OverscriptBox[
      SubscriptBox["q", "1"], "."]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["A", "."], "10"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", 
       SubscriptBox["x", "b"]}], "]"}], 
     SubscriptBox[
      OverscriptBox["x", "."], "b"]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", 
       SubscriptBox["y", "b"]}], "]"}], 
     SubscriptBox[
      OverscriptBox["y", "."], "b"]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", "\[Theta]"}], "]"}], 
     OverscriptBox["\[Theta]", "."]}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", 
       SubscriptBox["q", "1"]}], "]"}], 
     OverscriptBox[
      SubscriptBox["q", "1"], "."]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["A", "."], "20"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SubscriptBox["A", "20"], ",", 
        SubscriptBox["x", "b"]}], "]"}], 
      SubscriptBox[
       OverscriptBox["x", "."], "b"]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SubscriptBox["A", "20"], ",", 
        SubscriptBox["y", "b"]}], "]"}], 
      SubscriptBox[
       OverscriptBox["y", "."], "b"]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SubscriptBox["A", "20"], ",", "\[Theta]"}], "]"}], 
      OverscriptBox["\[Theta]", "."]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SubscriptBox["A", "20"], ",", 
        SubscriptBox["q", "1"]}], "]"}], 
      OverscriptBox[
       SubscriptBox["q", "1"], "."]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SubscriptBox["A", "20"], ",", 
        SubscriptBox["q", "2"]}], "]"}], 
      OverscriptBox[
       SubscriptBox["q", "2"], "."]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "1"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], 
        SubscriptBox["m", "1"], 
        SuperscriptBox[
         SubscriptBox["l", "1"], "2"]}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "1"], 
        SubscriptBox["l", "1"]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "1"], 
        SubscriptBox["l", "1"]}], ",", "0", ",", "0", ",", 
       SubscriptBox["m", "1"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "2"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], 
        SubscriptBox["m", "2"], 
        SuperscriptBox[
         SubscriptBox["l", "2"], "2"]}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "2"], 
        SubscriptBox["l", "2"]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "2"], 
        SubscriptBox["l", "2"]}], ",", "0", ",", "0", ",", 
       SubscriptBox["m", "2"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["E", "1"], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Tr", "[", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["A", "."], "10"], " ", ".", 
      SubscriptBox["J", "1"], ".", 
      RowBox[{"Transpose", "[", 
       SubscriptBox[
        OverscriptBox["A", "."], "10"], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["E", "2"], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Tr", "[", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["A", "."], "20"], " ", ".", 
       SubscriptBox["J", "2"], ".", 
       RowBox[{"Transpose", "[", 
        SubscriptBox[
         OverscriptBox["A", "."], "20"], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Q", "1"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q12", ",", "Q13", ",", "Q14", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q12", ",", "Q22", ",", "Q23", ",", "Q24", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q13", ",", "Q23", ",", "Q33", ",", "Q34", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q14", ",", "Q24", ",", "Q34", ",", "Q44", ",", "0"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["x", "."], "b"], ",", 
       SubscriptBox[
        OverscriptBox["y", "."], "b"], ",", 
       OverscriptBox["\[Theta]", "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "1"], "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "2"], "."]}], "}"}], ".", 
     SubscriptBox["Q", "1"], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         OverscriptBox["x", "."], "b"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         OverscriptBox["y", "."], "b"], "}"}], ",", 
       RowBox[{"{", 
        OverscriptBox["\[Theta]", "."], "}"}], ",", 
       RowBox[{"{", 
        OverscriptBox[
         SubscriptBox["q", "1"], "."], "}"}], ",", 
       RowBox[{"{", 
        OverscriptBox[
         SubscriptBox["q", "2"], "."], "}"}]}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"eq", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Q", "1"], "=", 
   RowBox[{"SolveAlways", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["E", "1"], "\[Equal]", "eq"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["x", "."], "b"], ",", 
       SubscriptBox[
        OverscriptBox["y", "."], "b"], ",", 
       OverscriptBox["\[Theta]", "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "1"], "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "2"], "."]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Q", "1"], "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q11", ",", "Q12", ",", "Q13", ",", "Q14", ",", "0"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q12", ",", "Q22", ",", "Q23", ",", "Q24", ",", "0"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q13", ",", "Q23", ",", "Q33", ",", "Q34", ",", "0"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q14", ",", "Q24", ",", "Q34", ",", "Q44", ",", "0"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
      " ", "/.", 
     RowBox[{
      SubscriptBox["Q", "1"], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"w", " ", 
      RowBox[{"raporcie", ".", "pdf"}], " ", "Q1", 
      RowBox[{"(", 
       RowBox[{"1", ",", "3"}], ")"}], " ", "jest", " ", "zle"}], ",", " ", 
     RowBox[{
      RowBox[{"+", " ", "zamiast"}], " ", "-", " ", 
      RowBox[{"w", " ", 
       SubscriptBox["m", "1"], 
       SubscriptBox["bc", "0"]}]}]}], ")"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Q", "2"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q11", ",", "Q12", ",", "Q13", ",", "Q14", ",", "Q15"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q12", ",", "Q22", ",", "Q23", ",", "Q24", ",", "Q25"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q13", ",", "Q23", ",", "Q33", ",", "Q34", ",", "Q35"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q14", ",", "Q24", ",", "Q34", ",", "Q44", ",", "Q45"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Q15", ",", "Q25", ",", "Q35", ",", "Q45", ",", "Q55"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["x", "."], "b"], ",", 
       SubscriptBox[
        OverscriptBox["y", "."], "b"], ",", 
       OverscriptBox["\[Theta]", "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "1"], "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "2"], "."]}], "}"}], ".", 
     SubscriptBox["Q", "2"], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox[
         OverscriptBox["x", "."], "b"], "}"}], ",", 
       RowBox[{"{", 
        SubscriptBox[
         OverscriptBox["y", "."], "b"], "}"}], ",", 
       RowBox[{"{", 
        OverscriptBox["\[Theta]", "."], "}"}], ",", 
       RowBox[{"{", 
        OverscriptBox[
         SubscriptBox["q", "1"], "."], "}"}], ",", 
       RowBox[{"{", 
        OverscriptBox[
         SubscriptBox["q", "2"], "."], "}"}]}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"eq", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["E", "2"], "=", 
   RowBox[{"Simplify", "[", 
    SubscriptBox["E", "2"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Q", "2"], "=", 
   RowBox[{"SolveAlways", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["E", "2"], "\[Equal]", "eq"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["x", "."], "b"], ",", 
       SubscriptBox[
        OverscriptBox["y", "."], "b"], ",", 
       OverscriptBox["\[Theta]", "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "1"], "."], ",", 
       OverscriptBox[
        SubscriptBox["q", "2"], "."]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Q", "2"], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q11", ",", "Q12", ",", "Q13", ",", "Q14", ",", "Q15"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q12", ",", "Q22", ",", "Q23", ",", "Q24", ",", "Q25"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q13", ",", "Q23", ",", "Q33", ",", "Q34", ",", "Q35"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q14", ",", "Q24", ",", "Q34", ",", "Q44", ",", "Q45"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q15", ",", "Q25", ",", "Q35", ",", "Q45", ",", "Q55"}], 
        "}"}]}], "}"}], " ", "/.", 
     RowBox[{
      SubscriptBox["Q", "2"], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Q", "b"], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["m", "b"], ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["m", "b"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Ib", ",", "0", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
     "}"}]}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["x", "_"], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["m", "b"], 
       SubscriptBox["x", "b"]}], "+", 
      RowBox[{
       SubscriptBox["m", "1"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "b"], "+", 
         RowBox[{
          SubscriptBox["c", "0"], "a"}], "-", 
         RowBox[{
          SubscriptBox["s", "0"], "b"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          SubscriptBox["l", "1"], 
          SubscriptBox["c", "t1"]}]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["m", "2"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "b"], "+", 
         RowBox[{
          SubscriptBox["c", "0"], "a"}], "-", 
         RowBox[{
          SubscriptBox["s", "0"], "b"}], "+", 
         RowBox[{
          SubscriptBox["l", "1"], 
          SubscriptBox["c", "t1"]}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          SubscriptBox["l", "2"], 
          SubscriptBox["c", "t12"]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["m", "1"], "+", 
      SubscriptBox["m", "2"], "+", 
      SubscriptBox["m", "b"]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     SubscriptBox["Q", "1"], "+", 
     SubscriptBox["Q", "2"], "+", 
     SubscriptBox["Q", "b"]}], "]"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"w", " ", 
      RowBox[{"raporcie", ".", "pdf"}], " ", "Q1", 
      RowBox[{"(", 
       RowBox[{"1", ",", "3"}], ")"}], " ", "jest", " ", "zle"}], ",", " ", 
     RowBox[{
      RowBox[{"+", " ", "zamiast"}], " ", "-", " ", 
      RowBox[{"przy", " ", 
       SubscriptBox["m", "1"], 
       SubscriptBox["bc", "0"]}]}]}], ")"}], " ", "*)"}], "\n", 
  RowBox[{
   SubscriptBox["H", "b"], "=", 
   RowBox[{"H", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["H", "bm"], "=", 
   RowBox[{"H", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", 
      RowBox[{"4", ";;", "5"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["H", "m"], "=", 
   RowBox[{"H", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "5"}], ",", 
      RowBox[{"4", ";;", "5"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"qq", "  ", "=", 
   FormBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SubscriptBox["x", "b"]},
       {
        SubscriptBox["y", "b"]},
       {"\[Theta]"},
       {
        SubscriptBox["q", "1"]},
       {
        SubscriptBox["q", "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    TraditionalForm]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cfun", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"qq", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
        RowBox[{"qq", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
        RowBox[{"qq", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ")"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cfun", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"cfun", "[", 
        RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], 
      OverscriptBox[
       SubscriptBox["x", "b"], "."]}], "+", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"cfun", "[", 
        RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], 
      OverscriptBox[
       SubscriptBox["y", "b"], "."]}], "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"cfun", "[", 
        RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], 
      OverscriptBox["\[Theta]", "."]}], "+", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"cfun", "[", 
        RowBox[{"i", ",", "j", ",", "4"}], "]"}], "]"}], 
      OverscriptBox[
       SubscriptBox["q", "1"], "."]}], "+", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"cfun", "[", 
        RowBox[{"i", ",", "j", ",", "5"}], "]"}], "]"}], 
      OverscriptBox[
       SubscriptBox["q", "2"], "."]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cmat", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"1", ",", "3"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"1", ",", "4"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"1", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"2", ",", "4"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"2", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"3", ",", "3"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"3", ",", "4"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"3", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"4", ",", "3"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"4", ",", "4"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"4", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"5", ",", "3"}], "]"}], ",", 
       RowBox[{"Cfun", "[", 
        RowBox[{"5", ",", "4"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.7357115057283363`*^9, 3.735711576202367*^9}, {
   3.735711807098573*^9, 3.735711833666093*^9}, {3.7358145413721104`*^9, 
   3.7358145417951345`*^9}, 3.7358147105467863`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Sprawdzienie", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fromTeX", "[", "str_", "]"}], ":=", 
    RowBox[{"ToExpression", "[", 
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<\\\\,(\>\""}]}], "]"}], ",", 
      "TeXForm"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["s", "1"], "=", 
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["s", "2"], "=", 
     RowBox[{"Sin", "[", 
      SubscriptBox["q", "2"], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["s", "12"], "=", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["q", "1"], "+", 
       SubscriptBox["q", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "1"], "=", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "1"], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "2"], "=", 
     RowBox[{"Cos", "[", 
      SubscriptBox["q", "2"], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", "12"], "=", 
     RowBox[{"Cos", "[", 
      RowBox[{
       SubscriptBox["q", "1"], "+", 
       SubscriptBox["q", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C13", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\dot{q_{1}}(- \
\\\\frac{1}{2}m_{1}l_{1}c_{t1}-m_{2}l_{1}c_{t1}-\\\\frac{1}{2}m_{2}l_{2}c_{\
t12})+\\\\dot{q_{2}}(-\\\\frac{1}{2}m_{2}l_{2}c_{t12})\>\"", "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"C14", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<(\\\\dot{\\\\theta}+\\\\dot{q_{1}})(-\\\\frac{1}{2}m_{1}l_{1}c_{t1}\
-m_{2}l_{1}c_{t1}-\\\\frac{1}{2}m_{2}l_{2}c_{t12})+\\\\dot{q_{2}}(-\\\\frac{1}\
{2}m_{2}l_{2}c_{t12})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C15", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<-\\\\frac{1}{2}m_{2}l_{2}c_{t12}(\\\\dot{\\\\theta}+\\\\dot{q_{1}}+\
\\\\dot{q_{2}})\>\"", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"C23", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\dot{\\\\theta}(-\\\\frac{1}{2}m_{1}l_{1}s_{t1}-(as_{0}+bc_{0})\
m_{1}-\\\\frac{1}{2}m_{2}l_{2}s_{t12}-m_{2}(as_{0}+bc_{0}+l_{1}s_{t1}))+\\\\ \
\\\\dot{q_{1}}(-\\\\frac{1}{2}m_{1}l_{1}s_{t1}-\\\\frac{1}{2}m_{2}l_{2}s_{t12}\
-m_{2}l_{1}s_{t1})+\\\\dot{q_{2}}(-\\\\frac{1}{2}m_{2}l_{2}s_{t12})\>\"", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"C24", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<(\\\\dot{\\\\theta}+\\\\dot{q_{1}})(-\\\\frac{1}{2}m_{1}l_{1}s_{t1}\
-\\\\frac{1}{2}m_{2}l_{2}s_{t12}-m_{2}l_{1}s_{t1})+\\\\dot{q_{2}}(-\\\\frac{1}\
{2}m_{2}l_{2}s_{t12})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C25", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<(\\\\dot{\\\\theta}+\\\\dot{q_{1}}+\\\\dot{q_{2}})(-\\\\frac{1}{2}\
m_{2}l_{2}s_{t12})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C33", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\dot{q_{1}}( \
\\\\frac{1}{2}m_{1}l_{1}(bc_{1}-as_{1})+m_{2}l_{1}(bc_{1}-as_{1})+\\\\frac{1}{\
2}m_{2}l_{2}(bc_{12}-as_{12}))+\\\\ \
\\\\dot{q_{2}}(-\\\\frac{1}{2}m_{2}l_{1}l_{2}s_{2}+\\\\frac{1}{2}m_{2}l_{2}(\
bc_{12}-as_{12}))\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C34", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<( \\\\dot{\\\\theta}+\\\\dot{q_{1}})(\\\\frac{1}{2}m_{1}l_{1}(bc_{\
1}-as_{1})+m_{2}l_{1}(bc_{1}-as_{1})+\\\\frac{1}{2}m_{2}l_{2}(bc_{12}-as_{12})\
)+\\\\ \\\\dot{q_{2}}(-\\\\frac{1}{2}m_{2}l_{1}l_{2}s_{2}+\\\\frac{1}{2}m_{2}\
l_{2}(bc_{12}-as_{12}))\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C35", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<( \\\\dot{\\\\theta}+\\\\dot{q_{1}}+\\\\dot{q_{2}})(-\\\\frac{1}{2}\
m_{2}l_{1}l_{2}s_{2}+\\\\frac{1}{2}m_{2}l_{2}(bc_{12}-as_{12}))\>\"", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C43", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\dot{\\\\theta}(-\\\\frac{1}{2}m_{1}l_{1}(bc_{1}-as_{1})-m_{2}l_\
{1}(bc_{1}-as_{1})-\\\\frac{1}{2}m_{2}l_{2}(bc_{12}-as_{12}))+\\\\ \
\\\\dot{q_{2}}(-\\\\frac{1}{2}m_{2}l_{1}l_{2}s_{2})\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C44", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<- \\\\frac{1}{2}m_{2}l_{1}l_{2}s_{2}\\\\dot{q_{2}}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C45", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<( \\\\dot{\\\\theta}+\\\\dot{q_{1}}+\\\\dot{q_{2}})(-\\\\frac{1}{2}\
m_{2}l_{1}l_{2}s_{2})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C53", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\< \\\\dot{\\\\theta}(\\\\frac{1}{2}m_{2}l_{1}l_{2}s_{2}-\\\\frac{1}{\
2}m_{2}l_{2}(bc_{12}-as_{12}))+\\\\frac{1}{2}m_{2}l_{1}l_{2}s_{2}\\\\dot{q_{1}\
}\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C54", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<( \\\\dot{\\\\theta}+\\\\dot{q_{1}})(\\\\frac{1}{2}m_{2}l_{1}l_{2}\
s_{2})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", 
      RowBox[{"12", "t"}]], "=", 
     SubscriptBox["c", "t12"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["c", 
      RowBox[{"1", "t"}]], "=", 
     SubscriptBox["c", "t1"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["s", 
      RowBox[{"12", "t"}]], "=", 
     SubscriptBox["s", "t12"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["s", 
      RowBox[{"1", "t"}]], "=", 
     SubscriptBox["s", "t1"]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q111", "=", 
     RowBox[{"fromTeX", "[", "\"\<m_{1}\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q112", "=", 
     RowBox[{"fromTeX", "[", "\"\<0\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q113", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<-\\\\frac{1}{2}m_{1}l_{1}s_{t1}-m_{1}as_{0}+m_{1}bc_{0}\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q114", "=", 
     RowBox[{
     "fromTeX", "[", "\"\<-\\\\frac{1}{2}m_{1}l_{1}s_{t1}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q122", "=", 
     RowBox[{"fromTeX", "[", "\"\<m_{1}\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q123", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\< \\\\frac{1}{2}m_{1}l_{1}c_{t1}+m_{1}ac_{0}-m_{1}bs_{0}\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q124", "=", 
     RowBox[{
     "fromTeX", "[", "\"\<\\\\frac{1}{2}m_{1}l_{1}c_{t1}\>\"", "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q133", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{3}m_{1}l_{1}^{2}+m_{1}(a^{2}+b^{2})+m_{1}l_{1}(ac_{1}+\
bs_{1})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q134", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\< \\\\frac{1}{3}m_{1}l_{1}^{2}+\\\\frac{1}{2}m_{1}l_{1}(ac_{1}+bs_{\
1})\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q144", "=", 
     RowBox[{"fromTeX", "[", "\"\<\\\\frac{1}{3}m_{1}l_{1}^{2}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q211", "=", 
     RowBox[{"fromTeX", "[", "\"\<m_{2}\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q212", "=", 
     RowBox[{"fromTeX", "[", "\"\<0\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q213", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\< -\\\\frac{1}{2}m_{2}l_{2}s_{t12}-m_{2}(as_{0}+bc_{0}+l_{1}s_{t1})\
\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q214", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<-\\\\frac{1}{2}m_{2}l_{2}s_{t12}-m_{2}l_{1}s_{t1}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q215", "=", 
     RowBox[{
     "fromTeX", "[", "\"\<-\\\\frac{1}{2}m_{2}l_{2}s_{t12}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q222", "=", 
     RowBox[{"fromTeX", "[", "\"\<m_{2}\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q223", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{2}m_{2}l_{2}c_{t12}+m_{2}(ac_{0}-bs_{0}+l_{1}c_{t1})\>\
\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q224", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{2}m_{2}l_{2}c_{t12}+m_{2}l_{1}c_{t1}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q225", "=", 
     RowBox[{
     "fromTeX", "[", "\"\<\\\\frac{1}{2}m_{2}l_{2}c_{t12}\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q233", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{3}m_{2}l_{2}^{2}+m_{2}(l_{1}^{2}+a^{2}+b^{2})+2m_{2}l_{\
1}(ac_{1}+bs_{1})+m_{2}l_{1}l_{2}c_{2}+m_{2}l_{2}(ac_{12}+bs_{12})\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q234", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{3}m_{2}l_{2}^{2}+m_{2}l_{1}^{2}+\\\\frac{1}{2}m_{2}l_{\
2}(ac_{12}+bs_{12})+m_{2}l_{1}l_{2}c_{2}+m_{2}l_{1}(ac_{1}+bs_{1})\>\"", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q235", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{3}m_{2}l_{2}^{2}+\\\\frac{1}{2}m_{2}l_{1}l_{2}c_{2}+\\\
\\frac{1}{2}m_{2}l_{2}(ac_{12}+bs_{12})\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q244", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{3}m_{2}l_{2}^{2}+m_{2}l_{1}^{2}+m_{2}l_{1}l_{2}c_{2}\>\
\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q245", "=", 
     RowBox[{
     "fromTeX", "[", 
      "\"\<\\\\frac{1}{3}m_{2}l_{2}^{2}+\\\\frac{1}{2}m_{2}l_{1}l_{2}c_{2}\>\"\
", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q255", "=", 
     RowBox[{
      FractionBox["1", "3"], 
      SubscriptBox["m", "2"], 
      SubsuperscriptBox["l", "2", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q1test", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q111", ",", "Q112", ",", "Q113", ",", "Q114", ",", "0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q112", ",", "Q122", ",", "Q123", ",", "Q124", ",", "0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q113", ",", "Q123", ",", "Q133", ",", "Q134", ",", "0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q114", ",", "Q124", ",", "Q134", ",", "Q144", ",", "0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q2test", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Q211", ",", "Q212", ",", "Q213", ",", "Q214", ",", "Q215"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q212", ",", "Q222", ",", "Q223", ",", "Q224", ",", "Q225"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q213", ",", "Q223", ",", "Q233", ",", "Q234", ",", "Q235"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q214", ",", "Q224", ",", "Q234", ",", "Q244", ",", "Q245"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Q215", ",", "Q225", ",", "Q235", ",", "Q245", ",", "Q255"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "b"], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["m", "b"], ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         SubscriptBox["m", "b"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Ib", ",", "0", ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
      "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ctest", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "C13", ",", "C14", ",", "C15"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "C23", ",", "C24", ",", "C25"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "C33", ",", "C34", ",", "C35"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "C43", ",", "C44", ",", "C45"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "C53", ",", "C54", ",", "0"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Htest", "=", 
     RowBox[{"Q1test", "+", "Q2test", "+", 
      SubscriptBox["Q", "b"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.732783254793421*^9, 3.7327832803877163`*^9}, {
   3.732783312559383*^9, 3.73278331607379*^9}, {3.7327833799367247`*^9, 
   3.7327833902529464`*^9}, {3.732783773596946*^9, 3.732783775581149*^9}, {
   3.732783913832573*^9, 3.7327839173591795`*^9}, 3.7327840766479745`*^9, {
   3.73278415880867*^9, 3.7327841778375654`*^9}, {3.7327842512255697`*^9, 
   3.7327842556709785`*^9}, {3.732784291509854*^9, 3.732784365602255*^9}, {
   3.732784651376585*^9, 3.7327846536565905`*^9}, {3.732784687922514*^9, 
   3.7327846937879257`*^9}, {3.732784732667811*^9, 3.7327848205543957`*^9}, {
   3.7327865123260098`*^9, 3.7327866187100368`*^9}, 3.7327866583797083`*^9, {
   3.7327867251052322`*^9, 3.7327867332212467`*^9}, {3.732786851520906*^9, 
   3.732786880645817*^9}, {3.7327869609923897`*^9, 3.7327869914340863`*^9}, {
   3.7327871319203854`*^9, 3.7327871856074853`*^9}, {3.732787240462221*^9, 
   3.7327873182879777`*^9}, {3.732787355389676*^9, 3.7327873994225664`*^9}, {
   3.732787474665541*^9, 3.7327875362606564`*^9}, {3.732787608783421*^9, 
   3.7327876569247093`*^9}, 3.7327877423170996`*^9, {3.732787858708943*^9, 
   3.7327878980954213`*^9}, {3.732787951819153*^9, 3.7327879573445625`*^9}, {
   3.732788038520924*^9, 3.7327880663798056`*^9}, {3.7327884576908226`*^9, 
   3.732788514400066*^9}, {3.7327886628295555`*^9, 3.732788668817898*^9}, {
   3.732788966274912*^9, 3.7327889786476192`*^9}, {3.732789925273763*^9, 
   3.7327899253087654`*^9}, {3.7327899674551764`*^9, 3.732790026170534*^9}, {
   3.7327901115754194`*^9, 3.7327902007815704`*^9}, {3.7327902317618284`*^9, 
   3.7327902522464657`*^9}, {3.7327908052771053`*^9, 
   3.7327908190905356`*^9}, {3.7327908526460047`*^9, 3.732790853390608*^9}, {
   3.7327911090964203`*^9, 3.732791110301623*^9}, {3.7327911794395866`*^9, 
   3.732791195460418*^9}, 3.732791245912739*^9, {3.732791311005313*^9, 
   3.7327913804964647`*^9}, {3.7327914224911695`*^9, 3.73279144009041*^9}, {
   3.7328043217155886`*^9, 3.7328043374514885`*^9}, {3.7328043751366444`*^9, 
   3.732804523760145*^9}, {3.732804559268176*^9, 3.7328047752965317`*^9}, {
   3.7328048273205075`*^9, 3.7328048984235744`*^9}, {3.7328049468713455`*^9, 
   3.7328049671995087`*^9}, {3.7328050090579023`*^9, 
   3.7328050100959616`*^9}, {3.7328050731145663`*^9, 3.73280508139504*^9}, {
   3.7328051338780413`*^9, 3.7328052196299467`*^9}, {3.732805262973426*^9, 
   3.7328053295822353`*^9}, {3.7328053639422007`*^9, 
   3.7327193621776724`*^9}, {3.735814590820939*^9, 3.7358146142442784`*^9}, {
   3.735814650414347*^9, 3.7358147105167847`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Htest", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.732783254793421*^9, 3.7327832803877163`*^9}, {
   3.732783312559383*^9, 3.73278331607379*^9}, {3.7327833799367247`*^9, 
   3.7327833902529464`*^9}, {3.732783773596946*^9, 3.732783775581149*^9}, {
   3.732783913832573*^9, 3.7327839173591795`*^9}, 3.7327840766479745`*^9, {
   3.73278415880867*^9, 3.7327841778375654`*^9}, {3.7327842512255697`*^9, 
   3.7327842556709785`*^9}, {3.732784291509854*^9, 3.732784365602255*^9}, {
   3.732784651376585*^9, 3.7327846536565905`*^9}, {3.732784687922514*^9, 
   3.7327846937879257`*^9}, {3.732784732667811*^9, 3.7327848205543957`*^9}, {
   3.7327865123260098`*^9, 3.7327866187100368`*^9}, 3.7327866583797083`*^9, {
   3.7327867251052322`*^9, 3.7327867332212467`*^9}, {3.732786851520906*^9, 
   3.732786880645817*^9}, {3.7327869609923897`*^9, 3.7327869914340863`*^9}, {
   3.7327871319203854`*^9, 3.7327871856074853`*^9}, {3.732787240462221*^9, 
   3.7327873182879777`*^9}, {3.732787355389676*^9, 3.7327873994225664`*^9}, {
   3.732787474665541*^9, 3.7327875362606564`*^9}, {3.732787608783421*^9, 
   3.7327876569247093`*^9}, 3.7327877423170996`*^9, {3.732787858708943*^9, 
   3.7327878980954213`*^9}, {3.732787951819153*^9, 3.7327879573445625`*^9}, {
   3.732788038520924*^9, 3.7327880663798056`*^9}, {3.7327884576908226`*^9, 
   3.732788514400066*^9}, {3.7327886628295555`*^9, 3.732788668817898*^9}, {
   3.732788966274912*^9, 3.7327889786476192`*^9}, {3.732789925273763*^9, 
   3.7327899253087654`*^9}, {3.7327899674551764`*^9, 3.732790026170534*^9}, {
   3.7327901115754194`*^9, 3.7327902007815704`*^9}, {3.7327902317618284`*^9, 
   3.7327902522464657`*^9}, {3.7327908052771053`*^9, 
   3.7327908190905356`*^9}, {3.7327908526460047`*^9, 3.732790853390608*^9}, {
   3.7327911090964203`*^9, 3.732791110301623*^9}, {3.7327911794395866`*^9, 
   3.732791195460418*^9}, 3.732791245912739*^9, {3.732791311005313*^9, 
   3.7327913804964647`*^9}, {3.7327914224911695`*^9, 3.73279144009041*^9}, {
   3.7328043217155886`*^9, 3.7328043374514885`*^9}, {3.7328043751366444`*^9, 
   3.732804523760145*^9}, {3.732804559268176*^9, 3.7328047752965317`*^9}, {
   3.7328048273205075`*^9, 3.7328048984235744`*^9}, {3.7328049468713455`*^9, 
   3.7328049671995087`*^9}, {3.7328050090579023`*^9, 
   3.7328050100959616`*^9}, {3.7328050731145663`*^9, 3.73280508139504*^9}, {
   3.7328051338780413`*^9, 3.7328052196299467`*^9}, {3.732805262973426*^9, 
   3.7328053295822353`*^9}, {3.7328053639422007`*^9, 
   3.7327193621776724`*^9}, {3.735814590820939*^9, 3.735814600775508*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["m", "1"], "+", 
       SubscriptBox["m", "2"], "+", 
       SubscriptBox["m", "b"]}], "0", 
      RowBox[{
       RowBox[{"b", " ", 
        SubscriptBox["c", "0"], " ", 
        SubscriptBox["m", "1"]}], "-", 
       RowBox[{"a", " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "0"]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "t1"]}], "-", 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           SubscriptBox["c", "0"]}], "+", 
          RowBox[{"a", " ", 
           SubscriptBox["s", "0"]}], "+", 
          RowBox[{
           SubscriptBox["l", "1"], " ", 
           SubscriptBox["s", "t1"]}]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["s", "t12"]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "t1"]}], "-", 
       RowBox[{
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["s", "t1"]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["s", "t12"]}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SubscriptBox["l", "2"], " ", 
       SubscriptBox["m", "2"], " ", 
       SubscriptBox["s", "t12"]}]},
     {"0", 
      RowBox[{
       SubscriptBox["m", "1"], "+", 
       SubscriptBox["m", "2"], "+", 
       SubscriptBox["m", "b"]}], 
      RowBox[{
       RowBox[{"a", " ", 
        SubscriptBox["c", "0"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t1"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t12"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "-", 
       RowBox[{"b", " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "0"]}], "+", 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           SubscriptBox["c", "0"]}], "+", 
          RowBox[{
           SubscriptBox["c", "t1"], " ", 
           SubscriptBox["l", "1"]}], "-", 
          RowBox[{"b", " ", 
           SubscriptBox["s", "0"]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t1"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        SubscriptBox["c", "t1"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t12"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SubscriptBox["c", "t12"], " ", 
       SubscriptBox["l", "2"], " ", 
       SubscriptBox["m", "2"]}]},
     {
      RowBox[{
       RowBox[{"b", " ", 
        SubscriptBox["c", "0"], " ", 
        SubscriptBox["m", "1"]}], "-", 
       RowBox[{"a", " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "0"]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "t1"]}], "-", 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           SubscriptBox["c", "0"]}], "+", 
          RowBox[{"a", " ", 
           SubscriptBox["s", "0"]}], "+", 
          RowBox[{
           SubscriptBox["l", "1"], " ", 
           SubscriptBox["s", "t1"]}]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["s", "t12"]}]}], 
      RowBox[{
       RowBox[{"a", " ", 
        SubscriptBox["c", "0"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t1"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t12"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "-", 
       RowBox[{"b", " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "0"]}], "+", 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           SubscriptBox["c", "0"]}], "+", 
          RowBox[{
           SubscriptBox["c", "t1"], " ", 
           SubscriptBox["l", "1"]}], "-", 
          RowBox[{"b", " ", 
           SubscriptBox["s", "0"]}]}], ")"}]}]}], 
      RowBox[{"Ib", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"]}], ")"}], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SubsuperscriptBox["l", "1", "2"]}], ")"}], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["s", "t1"]}], "-", 
       RowBox[{
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["s", "t1"]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["s", "t12"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t1"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        SubscriptBox["c", "t1"], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SubscriptBox["c", "t12"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["q", "1"], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "1"]}], "+", 
       RowBox[{
        SubsuperscriptBox["l", "1", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SubscriptBox["l", "2"], " ", 
       SubscriptBox["m", "2"], " ", 
       SubscriptBox["s", "t12"]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SubscriptBox["c", "t12"], " ", 
       SubscriptBox["l", "2"], " ", 
       SubscriptBox["m", "2"]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "+", 
             SubscriptBox["q", "2"]}], "]"}]}]}], ")"}], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}], " ", 
        SubscriptBox["l", "1"], " ", 
        SubscriptBox["l", "2"], " ", 
        SubscriptBox["m", "2"]}], "+", 
       RowBox[{
        FractionBox["1", "3"], " ", 
        SubsuperscriptBox["l", "2", "2"], " ", 
        SubscriptBox["m", "2"]}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       SubsuperscriptBox["l", "2", "2"], " ", 
       SubscriptBox["m", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7358146010755253`*^9, 3.735814629778167*^9}, 
   3.735814689413578*^9, 3.735814724907608*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Q1test", "-", 
    SubscriptBox["Q", "1"]}], " ", "//", "Simplify"}], " ", "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q2test", "-", 
    SubscriptBox["Q", "2"]}], " ", "//", "Simplify"}], " ", "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ctest", "-", "Cmat"}], "//", "Simplify"}], " ", "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.732783254793421*^9, 3.7327832803877163`*^9}, {
   3.732783312559383*^9, 3.73278331607379*^9}, {3.7327833799367247`*^9, 
   3.7327833902529464`*^9}, {3.732783773596946*^9, 3.732783775581149*^9}, {
   3.732783913832573*^9, 3.7327839173591795`*^9}, 3.7327840766479745`*^9, {
   3.73278415880867*^9, 3.7327841778375654`*^9}, {3.7327842512255697`*^9, 
   3.7327842556709785`*^9}, {3.732784291509854*^9, 3.732784365602255*^9}, {
   3.732784651376585*^9, 3.7327846536565905`*^9}, {3.732784687922514*^9, 
   3.7327846937879257`*^9}, {3.732784732667811*^9, 3.7327848205543957`*^9}, {
   3.7327865123260098`*^9, 3.7327866187100368`*^9}, 3.7327866583797083`*^9, {
   3.7327867251052322`*^9, 3.7327867332212467`*^9}, {3.732786851520906*^9, 
   3.732786880645817*^9}, {3.7327869609923897`*^9, 3.7327869914340863`*^9}, {
   3.7327871319203854`*^9, 3.7327871856074853`*^9}, {3.732787240462221*^9, 
   3.7327873182879777`*^9}, {3.732787355389676*^9, 3.7327873994225664`*^9}, {
   3.732787474665541*^9, 3.7327875362606564`*^9}, {3.732787608783421*^9, 
   3.7327876569247093`*^9}, 3.7327877423170996`*^9, {3.732787858708943*^9, 
   3.7327878980954213`*^9}, {3.732787951819153*^9, 3.7327879573445625`*^9}, {
   3.732788038520924*^9, 3.7327880663798056`*^9}, {3.7327884576908226`*^9, 
   3.732788514400066*^9}, {3.7327886628295555`*^9, 3.732788668817898*^9}, {
   3.732788966274912*^9, 3.7327889786476192`*^9}, {3.732789925273763*^9, 
   3.7327899253087654`*^9}, {3.7327899674551764`*^9, 3.732790026170534*^9}, {
   3.7327901115754194`*^9, 3.7327902007815704`*^9}, {3.7327902317618284`*^9, 
   3.7327902522464657`*^9}, {3.7327908052771053`*^9, 
   3.7327908190905356`*^9}, {3.7327908526460047`*^9, 3.732790853390608*^9}, {
   3.7327911090964203`*^9, 3.732791110301623*^9}, {3.7327911794395866`*^9, 
   3.732791195460418*^9}, 3.732791245912739*^9, {3.732791311005313*^9, 
   3.7327913804964647`*^9}, {3.7327914224911695`*^9, 3.73279144009041*^9}, {
   3.7328043217155886`*^9, 3.7328043374514885`*^9}, {3.7328043751366444`*^9, 
   3.732804523760145*^9}, {3.732804559268176*^9, 3.732804765840991*^9}, {
   3.7328049057989964`*^9, 3.7328049122533655`*^9}, {3.7328049562868843`*^9, 
   3.7328049782531404`*^9}, {3.7328050401576815`*^9, 3.732805041668768*^9}, {
   3.732805123916472*^9, 3.73280512860474*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{"2", " ", "b", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox["m", "1"]}], "0", "0"},
     {"0", "0", "0", "0", "0"},
     {
      RowBox[{"2", " ", "b", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox["m", "1"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.732804780977857*^9, 3.73280491670362*^9, 3.73280497982023*^9, {
   3.732805094770805*^9, 3.732719377347874*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.732804780977857*^9, 3.73280491670362*^9, 3.73280497982023*^9, {
   3.732805094770805*^9, 3.7327193773634744`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       OverscriptBox["\[Theta]", "."], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "+", 
               SubscriptBox["q", "1"]}], "]"}], " ", 
             SubscriptBox["l", "1"]}]}], ")"}], " ", 
          SubscriptBox["m", "1"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "+", 
               SubscriptBox["q", "1"]}], "]"}], " ", 
             SubscriptBox["l", "1"]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "+", 
               SubscriptBox["q", "1"], "+", 
               SubscriptBox["q", "2"]}], "]"}], " ", 
             SubscriptBox["l", "2"]}]}], ")"}], " ", 
          SubscriptBox["m", "2"]}]}], ")"}]}], "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.732804780977857*^9, 3.73280491670362*^9, 3.73280497982023*^9, {
   3.732805094770805*^9, 3.732719377722275*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Just", " ", "to", " ", "see", " ", "if", " ", "Q113", " ", "is", " ", 
    "the", " ", "problem"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"cfun", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"qq", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"qq", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"qq", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cfun", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], 
       OverscriptBox[
        SubscriptBox["x", "b"], "."]}], "+", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], 
       OverscriptBox[
        SubscriptBox["y", "b"], "."]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], 
       OverscriptBox["\[Theta]", "."]}], "+", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "4"}], "]"}], "]"}], 
       OverscriptBox[
        SubscriptBox["q", "1"], "."]}], "+", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "5"}], "]"}], "]"}], 
       OverscriptBox[
        SubscriptBox["q", "2"], "."]}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cmat", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "4"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Htest", "-", "H"}], "//", "Simplify"}], " ", "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ctest", "-", "Cmat"}], "//", "Simplify"}], " ", "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.7327194286481786`*^9, 3.7327194477884164`*^9}, {
  3.732719483176292*^9, 3.7327195039055347`*^9}, {3.7327196490060406`*^9, 
  3.73271979422395*^9}, {3.732719918839409*^9, 3.732719941330454*^9}, {
  3.735814554360853*^9, 3.735814559176129*^9}, {3.7358146193705716`*^9, 
  3.735814620178618*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{"2", " ", "b", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox["m", "1"]}], "0", "0"},
     {"0", "0", "0", "0", "0"},
     {
      RowBox[{"2", " ", "b", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       SubscriptBox["m", "1"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7327199827419357`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       OverscriptBox["\[Theta]", "."], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "+", 
               SubscriptBox["q", "1"]}], "]"}], " ", 
             SubscriptBox["l", "1"]}]}], ")"}], " ", 
          SubscriptBox["m", "1"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "a", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"2", " ", "b", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "+", 
               SubscriptBox["q", "1"]}], "]"}], " ", 
             SubscriptBox["l", "1"]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "+", 
               SubscriptBox["q", "1"], "+", 
               SubscriptBox["q", "2"]}], "]"}], " ", 
             SubscriptBox["l", "2"]}]}], ")"}], " ", 
          SubscriptBox["m", "2"]}]}], ")"}]}], "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.732719982757536*^9}]
}, Open  ]]
},
WindowSize->{1600, 828},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 28404, 865, 2679, "Input"],
Cell[28965, 887, 16441, 421, 2439, "Input"],
Cell[CellGroupData[{
Cell[45431, 1312, 2581, 35, 39, "Input"],
Cell[48015, 1349, 16714, 507, 249, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64766, 1861, 2751, 45, 90, "Input"],
Cell[67520, 1908, 1080, 29, 124, "Output"],
Cell[68603, 1939, 850, 23, 124, "Output"],
Cell[69456, 1964, 2250, 60, 134, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71743, 2029, 4567, 126, 348, "Input"],
Cell[76313, 2157, 987, 27, 124, "Output"],
Cell[77303, 2186, 2155, 58, 134, "Output"]
}, Open  ]]
}
]
*)

