(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     60559,       1577]
NotebookOptionsPosition[     59707,       1547]
NotebookOutlinePosition[     60085,       1563]
CellTagsIndexPosition[     60042,       1560]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Derivative", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"axis_", ",", "angle_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"axis", ",", "`X", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Sin", "[", "angle", "]"}]}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Sin", "[", "angle", "]"}], ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
          "]"}], ",", "`Y", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0", ",", 
              RowBox[{"Sin", "[", "angle", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Sin", "[", "angle", "]"}]}], ",", "0", ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
          "]"}], ",", "`Z", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "angle", "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Sin", "[", "angle", "]"}]}], ",", "0", ",", "0"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sin", "[", "angle", "]"}], ",", 
              RowBox[{"Cos", "[", "angle", "]"}], ",", "0", ",", "0"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
          "]"}]}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"axis_", ",", "sh_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mac", "=", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{"axis", ",", "`X", ",", 
         RowBox[{
          RowBox[{"mac", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}], "=", "sh"}], ",", "`Y", 
         ",", 
         RowBox[{
          RowBox[{"mac", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "4"}], "]"}], "]"}], "=", "sh"}], ",", "`Z", 
         ",", 
         RowBox[{
          RowBox[{"mac", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "4"}], "]"}], "]"}], "=", "sh"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "mac", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["s", "0"], "=", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["s", "t1"], "=", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "+", "q1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["s", "t12"], "=", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "+", "q1", "+", "q2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["c", "0"], "=", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["c", "t1"], "=", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "+", "q1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["c", "t12"], "=", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "+", "q1", "+", "q2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["x", "expr"], "=", 
   RowBox[{"(", 
    RowBox[{"xbar", "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["c", "0"], "a"}], "-", 
        RowBox[{
         SubscriptBox["s", "0"], "b"}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "1"], "2"], 
         SubscriptBox["c", "t1"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["c", "0"], "a"}], "-", 
        RowBox[{
         SubscriptBox["s", "0"], "b"}], "+", 
        RowBox[{
         SubscriptBox["l", "1"], 
         SubscriptBox["c", "t1"]}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "2"], "2"], 
         SubscriptBox["c", "t12"]}]}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["y", "expr"], "=", 
   RowBox[{"(", 
    RowBox[{"ybar", "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["s", "0"], "a"}], "+", 
        RowBox[{
         SubscriptBox["c", "0"], "b"}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "1"], "2"], 
         SubscriptBox["s", "t1"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["s", "0"], "a"}], "+", 
        RowBox[{
         SubscriptBox["c", "0"], "b"}], "+", 
        RowBox[{
         SubscriptBox["l", "1"], 
         SubscriptBox["s", "t1"]}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "2"], "2"], 
         SubscriptBox["s", "t12"]}]}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xbp", "\[Rule]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["x", "expr"], ",", "xbar"}], "]"}], "xbarp"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["x", "expr"], ",", "ybar"}], "]"}], "ybarp"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["x", "expr"], ",", "\[Theta]"}], "]"}], "\[Theta]p"}],
         "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["x", "expr"], ",", "q1"}], "]"}], "q1p"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["x", "expr"], ",", "q2"}], "]"}], "q2p"}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"ybp", "\[Rule]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["y", "expr"], ",", "xbar"}], "]"}], "xbarp"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["y", "expr"], ",", "ybar"}], "]"}], "ybarp"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["y", "expr"], ",", "\[Theta]"}], "]"}], "\[Theta]p"}],
         "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["y", "expr"], ",", "q1"}], "]"}], "q1p"}], "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           SubscriptBox["y", "expr"], ",", "q2"}], "]"}], "q2p"}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"xb", "\[Rule]", 
      SubscriptBox["x", "expr"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"yb", "\[Rule]", 
      SubscriptBox["y", "expr"]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "b0"], "=", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"X", ",", "xb"}], "]"}], ".", 
    RowBox[{"T", "[", 
     RowBox[{"Y", ",", "yb"}], "]"}], ".", 
    RowBox[{"R", "[", 
     RowBox[{"Z", ",", "\[Theta]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "b0"], "=", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{
     SubscriptBox["A", "b0"], ",", "rules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["A", "10"], "=", 
   RowBox[{
    SubscriptBox["A", "b0"], ".", 
    RowBox[{"T", "[", 
     RowBox[{"X", ",", "a"}], "]"}], ".", 
    RowBox[{"T", "[", 
     RowBox[{"Y", ",", "b"}], "]"}], ".", 
    RowBox[{"R", "[", 
     RowBox[{"Z", ",", "q1"}], "]"}], ".", 
    RowBox[{"T", "[", 
     RowBox[{"X", ",", 
      SubscriptBox["l", "1"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["A", "20"], "=", 
    RowBox[{
     SubscriptBox["A", "10"], ".", 
     RowBox[{"R", "[", 
      RowBox[{"Z", ",", "q2"}], "]"}], ".", 
     RowBox[{"T", "[", 
      RowBox[{"X", ",", 
       SubscriptBox["l", "2"]}], "]"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["A", "."], "b0"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", "xbar"}], "]"}], "xbarp"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", "ybar"}], "]"}], "ybarp"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", "\[Theta]"}], "]"}], "\[Theta]p"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", "q1"}], "]"}], "q1p"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "b0"], ",", "q2"}], "]"}], "q2p"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["A", "."], "10"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", "xbar"}], "]"}], "xbarp"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", "ybar"}], "]"}], "ybarp"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", "\[Theta]"}], "]"}], "\[Theta]p"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", "q1"}], "]"}], "q1p"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "10"], ",", "q2"}], "]"}], "q2p"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    OverscriptBox["A", "."], "20"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "20"], ",", "xbar"}], "]"}], "xbarp"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "20"], ",", "ybar"}], "]"}], "ybarp"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "20"], ",", "\[Theta]"}], "]"}], "\[Theta]p"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "20"], ",", "q1"}], "]"}], "q1p"}], "+", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["A", "20"], ",", "q2"}], "]"}], "q2p"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "1"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], 
        SubscriptBox["m", "1"], 
        SuperscriptBox[
         SubscriptBox["l", "1"], "2"]}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "1"], 
        SubscriptBox["l", "1"]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "1"], 
        SubscriptBox["l", "1"]}], ",", "0", ",", "0", ",", 
       SubscriptBox["m", "1"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["J", "2"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "3"], 
        SubscriptBox["m", "2"], 
        SuperscriptBox[
         SubscriptBox["l", "2"], "2"]}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "2"], 
        SubscriptBox["l", "2"]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SubscriptBox["m", "2"], 
        SubscriptBox["l", "2"]}], ",", "0", ",", "0", ",", 
       SubscriptBox["m", "2"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Q", "b"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mb", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "mb", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Ib", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
   " ", ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.735632479692527*^9, 3.7356325000791674`*^9}, {
   3.735632604809079*^9, 3.7356327303642607`*^9}, {3.7356327663183165`*^9, 
   3.735632794427925*^9}, {3.7356328662894077`*^9, 3.73563297960962*^9}, {
   3.735633087244689*^9, 3.73563311063554*^9}, {3.735633156775601*^9, 
   3.735633305351215*^9}, {3.7356333406839323`*^9, 3.735633446258278*^9}, {
   3.7356335099591403`*^9, 3.735633545617217*^9}, {3.735633580815978*^9, 
   3.7356337475772023`*^9}, {3.735633825890328*^9, 3.7356338277544346`*^9}, {
   3.7356341262530437`*^9, 3.7356341305448527`*^9}, {3.7356344997985616`*^9, 
   3.7356345779200296`*^9}, {3.7356346159742064`*^9, 3.735634693982668*^9}, {
   3.735635115311965*^9, 3.7356351274406586`*^9}, {3.7356356615152063`*^9, 
   3.735635731252195*^9}, {3.7356358398164043`*^9, 3.7356358540312176`*^9}, {
   3.7356359232121744`*^9, 3.73563600198268*^9}, {3.735636063944224*^9, 
   3.7356361530483203`*^9}, {3.7356362223072815`*^9, 3.735636362447297*^9}, {
   3.7356364691484003`*^9, 3.735636515740065*^9}, 3.735636557382447*^9, 
   3.735636690124039*^9, {3.735640285583688*^9, 3.73564029540825*^9}, {
   3.7356409671696725`*^9, 3.7356409856157274`*^9}, {3.735641211584652*^9, 
   3.735641214607825*^9}, {3.7356485978371215`*^9, 3.735648650292122*^9}, {
   3.7356492998512745`*^9, 3.735649320336446*^9}, {3.735650178971557*^9, 
   3.73565018356182*^9}, {3.735651842375698*^9, 3.73565190342219*^9}, {
   3.7356519428474455`*^9, 3.735652007740157*^9}, {3.735653917079365*^9, 
   3.735653920653569*^9}, {3.735657482191066*^9, 3.7356574938957357`*^9}, {
   3.7356576020499215`*^9, 3.7356576068581963`*^9}, {3.7356579575066404`*^9, 
   3.735657961740883*^9}, {3.7357119451944723`*^9, 3.735712050951521*^9}, {
   3.7357120905997887`*^9, 3.7357121061746798`*^9}, {3.7357121924906163`*^9, 
   3.735712195843808*^9}, 3.7357298471280303`*^9, {3.7357432454494863`*^9, 
   3.7357432545350056`*^9}, {3.7358083686608644`*^9, 3.735808391019143*^9}, {
   3.735811207039975*^9, 3.7358112272191296`*^9}, {3.7358112732017593`*^9, 
   3.735811362747881*^9}, {3.7358117264356833`*^9, 3.7358117334500847`*^9}, {
   3.735811832035723*^9, 3.7358119104872103`*^9}, {3.735811942956067*^9, 
   3.7358119585559597`*^9}, {3.7358119919288683`*^9, 3.735811992408896*^9}, {
   3.7358120412486897`*^9, 3.735812076383699*^9}, {3.7358121519260197`*^9, 
   3.7358122125904894`*^9}, {3.7358122575580616`*^9, 3.735812273821992*^9}, {
   3.735812633937589*^9, 3.73581264444219*^9}, 3.7358126746269164`*^9, {
   3.735813040321255*^9, 3.7358130410232954`*^9}, {3.735813457188099*^9, 
   3.735813517091525*^9}, {3.7358136884603267`*^9, 3.735813717834007*^9}, 
   3.7358137482187443`*^9, {3.735899788474517*^9, 3.735899846511836*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["E", "1"], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Tr", "[", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["A", "."], "10"], " ", ".", 
      SubscriptBox["J", "1"], ".", 
      RowBox[{"Transpose", "[", 
       SubscriptBox[
        OverscriptBox["A", "."], "10"], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["E", "2"], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Tr", "[", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["A", "."], "20"], " ", ".", 
      SubscriptBox["J", "2"], ".", 
      RowBox[{"Transpose", "[", 
       SubscriptBox[
        OverscriptBox["A", "."], "20"], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["E", "3"], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     RowBox[{"Transpose", "[", 
      FormBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"xbp"},
          {"ybp"},
          {"\[Theta]p"},
          {"q1p"},
          {"q2p"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
       TraditionalForm], "]"}], ".", 
     SubscriptBox["Q", "b"], ".", 
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"xbp"},
         {"ybp"},
         {"\[Theta]p"},
         {"q1p"},
         {"q2p"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["E", "3"], "=", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{
     SubscriptBox["E", "3"], ",", "rules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ec", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CoefficientRules", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["E", "1"], "+", 
       SubscriptBox["E", "2"], "+", 
       SubscriptBox["E", "3"]}], ",", 
      RowBox[{"{", 
       RowBox[{
       "xbarp", ",", "ybarp", ",", "\[Theta]p", ",", "q1p", ",", "q2p"}], 
       "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"H11", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"Ec", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}], ")"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H12", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H13", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H14", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H15", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H22", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"Ec", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "5", ",", "2"}], "]"}], "]"}], ")"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H23", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"Ec", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "6", ",", "2"}], "]"}], "]"}], ")"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H24", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"Ec", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "7", ",", "2"}], "]"}], "]"}], ")"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H25", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"Ec", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "8", ",", "2"}], "]"}], "]"}], ")"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H33", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"Ec", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "9", ",", "2"}], "]"}], "]"}], ")"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H34", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"Ec", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "10", ",", "2"}], "]"}], "]"}], ")"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H35", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"Ec", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "11", ",", "2"}], "]"}], "]"}], ")"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H44", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"Ec", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "12", ",", "2"}], "]"}], "]"}], ")"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H45", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"Ec", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "13", ",", "2"}], "]"}], "]"}], ")"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H55", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{"Ec", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "14", ",", "2"}], "]"}], "]"}], ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Htry3", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"H11", ",", "H12", ",", "H13", ",", "H14", ",", "H15"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"H12", ",", "H22", ",", "H23", ",", "H24", ",", "H25"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"H13", ",", "H23", ",", "H33", ",", "H34", ",", "H35"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"H14", ",", "H24", ",", "H34", ",", "H44", ",", "H45"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"H15", ",", "H25", ",", "H35", ",", "H45", ",", "H55"}], 
       "}"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.735632479692527*^9, 3.7356325000791674`*^9}, {
   3.735632604809079*^9, 3.7356327303642607`*^9}, {3.7356327663183165`*^9, 
   3.735632794427925*^9}, {3.7356328662894077`*^9, 3.73563297960962*^9}, {
   3.735633087244689*^9, 3.73563311063554*^9}, {3.735633156775601*^9, 
   3.735633305351215*^9}, {3.7356333406839323`*^9, 3.735633446258278*^9}, {
   3.7356335099591403`*^9, 3.735633545617217*^9}, {3.735633580815978*^9, 
   3.7356337475772023`*^9}, {3.735633825890328*^9, 3.7356338277544346`*^9}, {
   3.7356341262530437`*^9, 3.7356341305448527`*^9}, {3.7356344997985616`*^9, 
   3.7356345779200296`*^9}, {3.7356346159742064`*^9, 3.735634693982668*^9}, {
   3.735635115311965*^9, 3.7356351274406586`*^9}, {3.7356356615152063`*^9, 
   3.735635731252195*^9}, {3.7356358398164043`*^9, 3.7356358540312176`*^9}, {
   3.7356359232121744`*^9, 3.73563600198268*^9}, {3.735636063944224*^9, 
   3.7356361530483203`*^9}, {3.7356362223072815`*^9, 3.735636362447297*^9}, {
   3.7356364691484003`*^9, 3.735636515740065*^9}, 3.735636557382447*^9, 
   3.735636690124039*^9, {3.735640285583688*^9, 3.73564029540825*^9}, {
   3.7356409671696725`*^9, 3.7356409856157274`*^9}, {3.735641211584652*^9, 
   3.735641214607825*^9}, {3.7356485978371215`*^9, 3.735648650292122*^9}, {
   3.7356492998512745`*^9, 3.735649320336446*^9}, {3.735650178971557*^9, 
   3.73565018356182*^9}, {3.735651842375698*^9, 3.73565190342219*^9}, {
   3.7356519428474455`*^9, 3.735652007740157*^9}, {3.735653917079365*^9, 
   3.735653920653569*^9}, {3.735657482191066*^9, 3.7356574938957357`*^9}, {
   3.7356576020499215`*^9, 3.7356576068581963`*^9}, {3.7356579575066404`*^9, 
   3.735657961740883*^9}, {3.7357119451944723`*^9, 3.735712050951521*^9}, {
   3.7357120905997887`*^9, 3.7357121061746798`*^9}, {3.7357121924906163`*^9, 
   3.735712195843808*^9}, 3.7357298471280303`*^9, {3.7357432454494863`*^9, 
   3.7357432545350056`*^9}, {3.7358083686608644`*^9, 3.735808391019143*^9}, {
   3.735811207039975*^9, 3.7358112272191296`*^9}, {3.735811893746253*^9, 
   3.7358119104382076`*^9}, {3.735811942917065*^9, 3.735811958598962*^9}, {
   3.735812076424701*^9, 3.7358121330369396`*^9}, {3.7358134571510963`*^9, 
   3.735813490662013*^9}, {3.73581360250141*^9, 3.735813602897433*^9}, {
   3.735813711459642*^9, 3.735813717810005*^9}, {3.735813767811865*^9, 
   3.735813768474903*^9}, {3.735899807112583*^9, 3.735899846528837*^9}, 
   3.735899977327319*^9, 3.7359001947327538`*^9, 3.7359002747553306`*^9, {
   3.735900313629554*^9, 3.735900317147755*^9}, 3.7359007053509593`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qq", "  ", "=", 
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"xbar"},
         {"ybar"},
         {"\[Theta]"},
         {"q1"},
         {"q2"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cfun", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"qq", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"qq", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"qq", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cfun", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "xbarp"}], "+", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "ybarp"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], "\[Theta]p"}], "+", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "4"}], "]"}], "]"}], "q1p"}], "+", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"cfun", "[", 
         RowBox[{"i", ",", "j", ",", "5"}], "]"}], "]"}], "q2p"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H", "=", "Htry3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cmat", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"1", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "2"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"2", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "2"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"3", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "1"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "2"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"4", ",", "5"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "1"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "2"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "3"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "4"}], "]"}], ",", 
         RowBox[{"Cfun", "[", 
          RowBox[{"5", ",", "5"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.724773437132744*^9, {3.72872887015635*^9, 3.728728912052747*^9}, {
   3.7287289487968483`*^9, 3.7287290035959826`*^9}, {3.728729039853057*^9, 
   3.728729040054068*^9}, 3.728729121932751*^9, {3.7287292586265697`*^9, 
   3.7287292603856707`*^9}, {3.7287317122359085`*^9, 3.7287317178342285`*^9}, 
   3.7287317551133604`*^9, 3.7287319301293707`*^9, {3.72873261825873*^9, 
   3.7287326325075445`*^9}, {3.7302755394579124`*^9, 
   3.7302755436043215`*^9}, {3.7327725352040744`*^9, 
   3.7327725662498503`*^9}, {3.7327758548209457`*^9, 
   3.7327758624823837`*^9}, {3.732775930970301*^9, 3.732776030449991*^9}, {
   3.7327762939680634`*^9, 3.7327763461080456`*^9}, {3.7327766454811687`*^9, 
   3.7327766702975883`*^9}, {3.7327767956387577`*^9, 
   3.7327768305537543`*^9}, {3.732777203457083*^9, 3.732777208222356*^9}, {
   3.7327779377460823`*^9, 3.7327779891360216`*^9}, 3.7327780294423265`*^9, {
   3.732778125744835*^9, 3.732778126981906*^9}, {3.732778378580374*^9, 
   3.7327784037630377`*^9}, 3.7327785129740753`*^9, {3.7327810254581017`*^9, 
   3.7327810412679343`*^9}, {3.7327877078020325`*^9, 3.732787757817328*^9}, {
   3.7327893353350205`*^9, 3.732789352383996*^9}, {3.732791245865939*^9, 
   3.7327913063999033`*^9}, 3.7327917857007847`*^9, 3.7327932657142134`*^9, {
   3.7328050564206114`*^9, 3.7327196152555685`*^9}, {3.7327197493826475`*^9, 
   3.7327197500690484`*^9}, {3.735632479692527*^9, 3.7356325000791674`*^9}, {
   3.735632604809079*^9, 3.7356327303642607`*^9}, {3.7356327663183165`*^9, 
   3.735632794427925*^9}, {3.7356328662894077`*^9, 3.73563297960962*^9}, {
   3.735633087244689*^9, 3.73563311063554*^9}, {3.735633156775601*^9, 
   3.735633305351215*^9}, {3.7356333406839323`*^9, 3.735633446258278*^9}, {
   3.7356335099591403`*^9, 3.735633545617217*^9}, {3.735633580815978*^9, 
   3.7356337475772023`*^9}, {3.735633825890328*^9, 3.7356338277544346`*^9}, {
   3.7356341262530437`*^9, 3.7356341305448527`*^9}, {3.7356344997985616`*^9, 
   3.7356345779200296`*^9}, {3.7356346159742064`*^9, 3.735634693982668*^9}, {
   3.735635115311965*^9, 3.7356351274406586`*^9}, {3.7356356615152063`*^9, 
   3.735635731252195*^9}, {3.7356358398164043`*^9, 3.7356358540312176`*^9}, {
   3.7356359232121744`*^9, 3.73563600198268*^9}, {3.735636063944224*^9, 
   3.7356361530483203`*^9}, {3.7356362223072815`*^9, 3.735636362447297*^9}, {
   3.7356364691484003`*^9, 3.735636515740065*^9}, 3.735636557382447*^9, 
   3.735636690124039*^9, {3.735636810903948*^9, 3.735636815071186*^9}, {
   3.7356480823716383`*^9, 3.735648090562107*^9}, {3.73564816474335*^9, 
   3.7356482270119114`*^9}, {3.7357110625849895`*^9, 
   3.7357110785489025`*^9}, {3.735713816211488*^9, 3.735713870303582*^9}, {
   3.735720945659373*^9, 3.7357209469751763`*^9}, {3.735723247681452*^9, 
   3.7357232683596344`*^9}, {3.735723541730077*^9, 3.735723552549696*^9}, 
   3.735723681563075*^9, {3.7357432474976034`*^9, 3.735743256113096*^9}, {
   3.735811859379287*^9, 3.7358118758212276`*^9}, {3.735812041416699*^9, 
   3.7358120758126664`*^9}, {3.735812794469702*^9, 3.7358127989029555`*^9}, {
   3.735813508523035*^9, 3.735813517038522*^9}, {3.7358136886993403`*^9, 
   3.735813696285774*^9}, {3.7358997885525217`*^9, 3.7358997977840495`*^9}, {
   3.7358999154317784`*^9, 3.7358999179279213`*^9}, {3.735900022075878*^9, 
   3.7359000353916397`*^9}, 3.7359002105586586`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"-", "Hs"}]}]}]}], ",", "Cs", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Bs", "--"}], "--"}], 
     RowBox[{"--", "-"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"B", "=", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "0", "0"},
         {"0", "0", "0", "1", "0"},
         {"0", "0", "0", "0", "1"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hb", "=", 
     RowBox[{"H", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", 
        RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hbm", "=", 
     RowBox[{"H", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "3"}], ",", 
        RowBox[{"4", ";;", "5"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Hs", "=", "H"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bs", "=", "B"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cs", "=", "Cmat"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Ib", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     FractionBox["1", "10"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", 
     FractionBox["2", "10"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["l", "1"], "=", 
     FractionBox["2", "10"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["l", "2"], "=", 
     FractionBox["3", "10"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mb", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "1"], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "2"], "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"invHs", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Inverse", "[", "Hs", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7357140933333387`*^9, 3.735714094373398*^9}, {
   3.735714128413345*^9, 3.7357142140042405`*^9}, {3.7357142980155344`*^9, 
   3.735714406301222*^9}, {3.7357145069520817`*^9, 3.735714612974161*^9}, {
   3.7357180981781015`*^9, 3.7357180986003017`*^9}, 3.735719027174827*^9, {
   3.735719071566971*^9, 3.7357191195611343`*^9}, {3.735719156881647*^9, 
   3.7357191573686485`*^9}, {3.7357191891843643`*^9, 3.735719199352612*^9}, {
   3.735720836072947*^9, 3.7357208491756964`*^9}, {3.7357210465881886`*^9, 
   3.7357210668632803`*^9}, 3.735721139638917*^9, {3.7357212317154474`*^9, 
   3.735721233893059*^9}, 3.7357212734052258`*^9, {3.7357213145549946`*^9, 
   3.735721316230198*^9}, {3.7357220923133864`*^9, 3.735722093897477*^9}, {
   3.7357224397122564`*^9, 3.7357224523869815`*^9}, {3.7357225890017953`*^9, 
   3.735722591475937*^9}, {3.7357277242836103`*^9, 3.735727727539797*^9}, {
   3.735727778803729*^9, 3.735727806898336*^9}, {3.7357281473928113`*^9, 
   3.73572815663934*^9}, {3.7357282766622047`*^9, 3.7357283010626*^9}, 
   3.735743456927582*^9, 3.7357435221433125`*^9, {3.735811859389288*^9, 
   3.735811875662218*^9}, {3.7358120414266996`*^9, 3.735812075824667*^9}, 
   3.73581281418283*^9, {3.7358129046930065`*^9, 3.7358129125284543`*^9}, {
   3.7358135085330353`*^9, 3.735813517046522*^9}, {3.735813688714341*^9, 
   3.7358136962987747`*^9}, {3.735899788565522*^9, 3.7358997977280464`*^9}, {
   3.735900022090879*^9, 3.7359000354076405`*^9}, {3.7359000817372904`*^9, 
   3.7359000860715384`*^9}, {3.7359002077745*^9, 3.735900208278528*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"-", "Save"}]}]}]}], " ", "to", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"txt", "--"}], "--"}], "--"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"strReplaceRules", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Cos[\[Theta]]\>\"", "\[Rule]", "\"\<c0\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Cos[q1]\>\"", "\[Rule]", "\"\<c1\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Cos[q2]\>\"", "\[Rule]", "\"\<c2\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\"\<Sin[\[Theta]]\>\"", "\[Rule]", "\"\<s1\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Sin[q1]\>\"", "\[Rule]", "\"\<s1\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Sin[q2]\>\"", "\[Rule]", "\"\<s2\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\"\<Sin[q1 + q2]\>\"", "\[Rule]", "\"\<s12\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Cos[q1 + q2]\>\"", "\[Rule]", "\"\<c12\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\"\<Derivative[1][\[Theta]]\>\"", "\[Rule]", "\"\<qp3\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Derivative[1][q1]\>\"", "\[Rule]", "\"\<qp4\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Derivative[1][q2]\>\"", "\[Rule]", "\"\<qp5\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\"\<Derivative[2][q1]\>\"", "\[Rule]", "\"\<qpp4\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Derivative[2][q2]\>\"", "\[Rule]", "\"\<qpp5\>\""}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"strReplaceRules2", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<qp3\>\"", "\[Rule]", "\"\<qp(3)\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<qp4\>\"", "\[Rule]", "\"\<qp(4)\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<qp5\>\"", "\[Rule]", "\"\<qp(5)\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\"\<qpp4\>\"", "\[Rule]", "\"\<qpp(4)\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<qpp5\>\"", "\[Rule]", "\"\<qpp(5)\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Theta]\>\"", "\[Rule]", "\"\<q(3)\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<q1\>\"", "\[Rule]", "\"\<q(4)\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<q2\>\"", "\[Rule]", "\"\<q(5)\>\""}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"PathStr", "=", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"Hs", ",", "InputForm"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"QStr", ",", "strReplaceRules"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QQ", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"ToExpression", "[", "QStr", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "ToMatlab`"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"matlabQ", "=", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{"QQ", ",", "\"\<Q\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matlabQQ", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"matlabQ", ",", "strReplaceRules2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"PathStr", "<>", " ", "\"\<Q.txt\>\""}], ",", "matlabQQ", ",", 
     RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF-8\>\""}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"Cs", ",", "InputForm"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"QStr", ",", "strReplaceRules"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QQ", "=", 
     RowBox[{"ToExpression", "[", "QStr", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "ToMatlab`"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"matlabQ", "=", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{"QQ", ",", "\"\<C\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matlabC", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"matlabQ", ",", "strReplaceRules2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"PathStr", "<>", " ", "\"\<C.txt\>\""}], ",", "matlabC", ",", 
     RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF-8\>\""}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"Bs", ",", "InputForm"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"QStr", ",", "strReplaceRules"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QQ", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"ToExpression", "[", "QStr", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "ToMatlab`"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"matlabQ", "=", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{"QQ", ",", "\"\<B\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matlabB", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"matlabQ", ",", "strReplaceRules2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"PathStr", "<>", " ", "\"\<B.txt\>\""}], ",", "matlabB", ",", 
     RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF-8\>\""}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"ToString", "[", 
      RowBox[{"invHs", ",", "InputForm"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QStr", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"QStr", ",", "strReplaceRules"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QQ", "=", 
     RowBox[{"ToExpression", "[", "QStr", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "ToMatlab`"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"matlabQ", "=", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{"QQ", ",", "\"\<invQ\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matlabInvQ", "=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"matlabQ", ",", "strReplaceRules2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"PathStr", "<>", " ", "\"\<invQ.txt\>\""}], ",", "matlabInvQ", 
     ",", 
     RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF-8\>\""}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"PathStr", "<>", " ", "\"\<AllMCDtry3.txt\>\""}], ",", 
     RowBox[{
     "matlabQQ", "<>", "matlabB", "<>", "matlabC", "<>", "matlabInvQ"}], ",", 
     RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF-8\>\""}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7357140933333387`*^9, 3.735714094373398*^9}, {
   3.735714128413345*^9, 3.7357142140042405`*^9}, {3.7357142980155344`*^9, 
   3.735714406301222*^9}, 3.7357179828770137`*^9, {3.735718069241227*^9, 
   3.7357180861608686`*^9}, {3.7357190568669257`*^9, 
   3.7357190642239485`*^9}, {3.7357190995532603`*^9, 
   3.7357191147591143`*^9}, {3.735719204617835*^9, 3.735719213127885*^9}, {
   3.7357193914193172`*^9, 3.735719441938207*^9}, 3.7357227300648637`*^9, {
   3.7357229061019325`*^9, 3.7357229235159283`*^9}, 3.735723459270554*^9, {
   3.7357247864311028`*^9, 3.735724872238011*^9}, {3.735724915984513*^9, 
   3.735724920029744*^9}, {3.7357249576708975`*^9, 3.7357250156132116`*^9}, {
   3.735725048079068*^9, 3.7357250978209133`*^9}, {3.7357251319518657`*^9, 
   3.7357251727772007`*^9}, {3.7357252748970413`*^9, 
   3.7357253302532077`*^9}, {3.73572538851554*^9, 3.7357254158271027`*^9}, {
   3.7357254720443172`*^9, 3.73572548466704*^9}, {3.7357256101382165`*^9, 
   3.735725688585703*^9}, {3.7357257252358*^9, 3.7357257515623055`*^9}, {
   3.735725790578537*^9, 3.735725829256749*^9}, {3.7357259753211036`*^9, 
   3.735725975856134*^9}, {3.7357260178235345`*^9, 3.735726202790114*^9}, {
   3.735726282573677*^9, 3.735726302972844*^9}, {3.7357417444816356`*^9, 
   3.735741744664646*^9}, {3.7357433164155455`*^9, 3.7357434155942183`*^9}, {
   3.7357434784598136`*^9, 3.7357434868132915`*^9}, {3.735743572344184*^9, 
   3.7357436020628834`*^9}, 3.7357436947821865`*^9, {3.7357444281311316`*^9, 
   3.735744431357316*^9}, {3.7357446553181257`*^9, 3.735744673244151*^9}, {
   3.735812076145685*^9, 3.735812076278693*^9}, {3.735812843056481*^9, 
   3.7358128915802565`*^9}, {3.735900102802496*^9, 3.7359001386225443`*^9}}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\Q.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735726654811968*^9, 3.735728357237814*^9, 3.7357284052295585`*^9, {
   3.735743559677459*^9, 3.7357436031929483`*^9}, 3.7357436981533794`*^9, 
   3.735744726660207*^9, 3.7357448180034313`*^9, 3.735900731118433*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\C.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735726654811968*^9, 3.735728357237814*^9, 3.7357284052295585`*^9, {
   3.735743559677459*^9, 3.7357436031929483`*^9}, 3.7357436981533794`*^9, 
   3.735744726660207*^9, 3.7357448180034313`*^9, 3.735900731169436*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\B.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735726654811968*^9, 3.735728357237814*^9, 3.7357284052295585`*^9, {
   3.735743559677459*^9, 3.7357436031929483`*^9}, 3.7357436981533794`*^9, 
   3.735744726660207*^9, 3.7357448180034313`*^9, 3.7359007311954374`*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\invQ.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735726654811968*^9, 3.735728357237814*^9, 3.7357284052295585`*^9, {
   3.735743559677459*^9, 3.7357436031929483`*^9}, 3.7357436981533794`*^9, 
   3.735744726660207*^9, 3.7357448180034313`*^9, 3.735900731251441*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\AllMCDtry3.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735726654811968*^9, 3.735728357237814*^9, 3.7357284052295585`*^9, {
   3.735743559677459*^9, 3.7357436031929483`*^9}, 3.7357436981533794`*^9, 
   3.735744726660207*^9, 3.7357448180034313`*^9, 3.7359007312664413`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["x", "expr"], "=", 
   RowBox[{"(", 
    RowBox[{"xbar", "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["c", "0"], "a"}], "-", 
        RowBox[{
         SubscriptBox["s", "0"], "b"}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "1"], "2"], 
         SubscriptBox["c", "t1"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["c", "0"], "a"}], "-", 
        RowBox[{
         SubscriptBox["s", "0"], "b"}], "+", 
        RowBox[{
         SubscriptBox["l", "1"], 
         SubscriptBox["c", "t1"]}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "2"], "2"], 
         SubscriptBox["c", "t12"]}]}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["y", "expr"], "=", 
   RowBox[{"(", 
    RowBox[{"ybar", "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["s", "0"], "a"}], "+", 
        RowBox[{
         SubscriptBox["c", "0"], "b"}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "1"], "2"], 
         SubscriptBox["s", "t1"]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{"mb", "+", 
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["s", "0"], "a"}], "+", 
        RowBox[{
         SubscriptBox["c", "0"], "b"}], "+", 
        RowBox[{
         SubscriptBox["l", "1"], 
         SubscriptBox["s", "t1"]}], "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["l", "2"], "2"], 
         SubscriptBox["s", "t12"]}]}], ")"}]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Str", "=", 
   RowBox[{"ToString", "[", 
    RowBox[{
     SubscriptBox["x", "expr"], ",", "InputForm"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QStr", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"Str", ",", "strReplaceRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ", "=", 
   RowBox[{"ToExpression", "[", "QStr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "ToMatlab`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"matlabQ", "=", 
   RowBox[{"ToMatlab", "[", 
    RowBox[{"QQ", ",", "\"\<xb\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matlabxexrp", "=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"matlabQ", ",", "strReplaceRules2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Str", "=", 
   RowBox[{"ToString", "[", 
    RowBox[{
     SubscriptBox["y", "expr"], ",", "InputForm"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QStr", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"Str", ",", "strReplaceRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ", "=", 
   RowBox[{"ToExpression", "[", "QStr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "ToMatlab`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"matlabQ", "=", 
   RowBox[{"ToMatlab", "[", 
    RowBox[{"QQ", ",", "\"\<yb\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matlabyexrp", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"matlabQ", ",", "strReplaceRules2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"PathStr", "<>", " ", "\"\<xyexpr.txt\>\""}], ",", 
   RowBox[{"matlabxexrp", "<>", "matlabyexrp"}], ",", 
   RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF-8\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.735739999441825*^9, 3.735740017145838*^9}, 
   3.7357436244781656`*^9, {3.7358136887383423`*^9, 3.7358136960977635`*^9}, {
   3.7359001268238697`*^9, 3.7359001285769696`*^9}}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\G.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735742093665608*^9, 3.7357421865629215`*^9, {3.7357422872686815`*^9, 
   3.7357423530714455`*^9}, 3.7357439797384853`*^9, 3.735744734155635*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\www\\\\Magisterka\\\\Mathematica\\\\Free \
Floating\\\\xyexpr.txt\"\>"], "Output",
 CellChangeTimes->{
  3.735742093665608*^9, 3.7357421865629215`*^9, {3.7357422872686815`*^9, 
   3.7357423530714455`*^9}, 3.7357439797384853`*^9, 3.7357447342286396`*^9}]
}, Open  ]]
},
WindowSize->{1600, 828},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 19248, 535, 1407, "Input"],
Cell[19809, 557, 10763, 270, 810, "Input"],
Cell[30575, 829, 8586, 194, 462, "Input"],
Cell[39164, 1025, 4306, 105, 634, "Input"],
Cell[CellGroupData[{
Cell[43495, 1134, 9420, 217, 1740, "Input"],
Cell[52918, 1353, 349, 5, 39, "Output"],
Cell[53270, 1360, 349, 5, 39, "Output"],
Cell[53622, 1367, 351, 5, 39, "Output"],
Cell[53976, 1374, 352, 5, 39, "Output"],
Cell[54331, 1381, 360, 5, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54728, 1391, 4392, 141, 475, "Input"],
Cell[59123, 1534, 279, 4, 39, "Output"],
Cell[59405, 1540, 286, 4, 39, "Output"]
}, Open  ]]
}
]
*)

